import"./engine-DyXn5MML.js";import"./navigation-C3rDQ7Kf.js";import"./metrics-DzcRmtC5.js";import"./enhancements-Cbf4HYrr.js";!function e(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)}).observe(document,{childList:!0,subtree:!0})}function n(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}function r(e){if(e.ep)return;e.ep=!0;const t=n(e);fetch(e.href,t)}}(),window.supabase&&(window._sbClient=window.supabase.createClient("https://ysmwkkdpjgjokukxolel.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlzbXdra2Rwamdqb2t1a3hvbGVsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwMzA3NDQsImV4cCI6MjA4NzYwNjc0NH0.4u56RJ61Q5cqnqMqIEWwg50q6MlV8bEvueA45enQgxE")),document.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()},!1),document.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation()},!1),window.S4=window.S4||{version:"5.12.0",env:"production",buildDate:"2026-02-26",modules:{},register:function(e,t){this.modules[e]=t},getModule:function(e){return this.modules[e]||null}},function(){S4.metrics={_data:{lcp:null,fid:null,cls:0,ttfb:null,fcp:null,errors:[],apiLatency:[]},_startTime:performance.now(),record:function(e,t){this._data[e]=t},addApiLatency:function(e,t){this._data.apiLatency.push({endpoint:e,ms:t,ts:Date.now()}),this._data.apiLatency.length>200&&this._data.apiLatency.shift()},getReport:function(){return Object.assign({},this._data,{uptime:Math.round((performance.now()-this._startTime)/1e3),memoryMB:performance.memory?Math.round(performance.memory.usedJSHeapSize/1048576):null,version:S4.version,env:S4.env,timestamp:(new Date).toISOString()})}};try{"undefined"!=typeof PerformanceObserver&&(new PerformanceObserver(function(e){var t=e.getEntries();t.length>0&&S4.metrics.record("lcp",Math.round(t[t.length-1].startTime))}).observe({type:"largest-contentful-paint",buffered:!0}),new PerformanceObserver(function(e){var t=e.getEntries();t.length>0&&S4.metrics.record("fid",Math.round(t[0].processingStart-t[0].startTime))}).observe({type:"first-input",buffered:!0}),new PerformanceObserver(function(e){var t;e.getEntries().forEach(function(e){e.hadRecentInput||(S4.metrics._data.cls+=e.value)}),S4.metrics._data.cls=Math.round(1e3*S4.metrics._data.cls)/1e3}).observe({type:"layout-shift",buffered:!0}),new PerformanceObserver(function(e){var t;e.getEntries().forEach(function(e){"first-contentful-paint"===e.name&&S4.metrics.record("fcp",Math.round(e.startTime))})}).observe({type:"paint",buffered:!0}))}catch(t){}window.addEventListener("load",function(){try{var e=performance.getEntriesByType("navigation")[0];e&&S4.metrics.record("ttfb",Math.round(e.responseStart-e.requestStart))}catch(t){}}),S4.errorReporter={_queue:[],_maxQueue:50,report:function(e){var t={message:"string"==typeof e?e:e.message||"Unknown error",stack:e.stack||null,url:window.location.href,timestamp:(new Date).toISOString(),version:S4.version,userAgent:navigator.userAgent.substring(0,200)};this._queue.push(t),this._queue.length>this._maxQueue&&this._queue.shift()},flush:async function(){if(0!==this._queue.length){var e=this._queue.splice(0);try{await fetch("/api/errors/report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({errors:e,session:sessionStorage.getItem("s4_session_id")||"unknown"})})}catch(t){this._queue=e.concat(this._queue)}}}},setInterval(function(){S4.errorReporter.flush()},6e4),window.addEventListener("beforeunload",function(){S4.errorReporter.flush()});var e=window.fetch;window.fetch=function(t,n){var r=performance.now(),o="string"==typeof t?t:t.url||"";if(o.startsWith("/api/"))if((n=n||{}).headers=n.headers||{},"function"==typeof n.headers.set);else{var a=sessionStorage.getItem("s4_auth_token");a&&(n.headers.Authorization="Bearer "+a);var s=S4.csrf?S4.csrf.getToken():null;s&&(n.headers["X-CSRF-Token"]=s),n.headers["X-S4-Version"]=S4.version,n.headers["X-S4-Client"]="web-prod"}return e.call(window,t,n).then(function(e){return o.startsWith("/api/")&&S4.metrics.addApiLatency(o.split("?")[0],Math.round(performance.now()-r)),e}).catch(function(e){throw o.startsWith("/api/")&&S4.metrics.addApiLatency(o.split("?")[0],-1),e})},S4.healthCheck=function(){var e={serviceWorker:"serviceWorker"in navigator,crypto:"undefined"!=typeof crypto&&void 0!==crypto.subtle,indexedDB:"undefined"!=typeof indexedDB,localStorage:function(){try{return localStorage.setItem("_hc","1"),localStorage.removeItem("_hc"),!0}catch(t){return!1}}(),webSocket:"undefined"!=typeof WebSocket,fetchAPI:"undefined"!=typeof fetch,webCrypto:"undefined"!=typeof crypto&&void 0!==crypto.subtle&&"function"==typeof crypto.subtle.digest,performance:"undefined"!=typeof PerformanceObserver};return e.allPassing=Object.values(e).every(function(e){return!0===e}),e},S4.register("monitoring",{version:"1.0.0",features:["web-vitals","error-reporter","api-interceptor","health-check"]})}(),S4.i18n={locale:(navigator.language||"en").split("-")[0],catalogs:{en:{"app.name":"S4 Ledger","nav.platform":"Platform","nav.useCases":"Use Cases","nav.pricing":"Pricing","nav.company":"Company","nav.docs":"Docs","nav.contact":"Contact Us","anchor.title":"Anchor Channel","anchor.placeholder":"Or paste/type your defense logistics record here...","anchor.button":"Anchor Record","verify.title":"Verify Channel","verify.placeholder":"Paste the original defense record content here...","vault.title":"Audit Record Vault","vault.empty":"No anchored records yet. Records will appear here automatically as you anchor them.","vault.search":"Search records by type, hash, content...","vault.exportCSV":"Export CSV","vault.exportXLSX":"Export XLSX","vault.reverifyAll":"Re-Verify All","vault.clear":"Clear Vault","toast.missingContent":"Please enter record content.","toast.noProgram":"Please select a program first.","toast.noAnalysis":"Run analysis first.","toast.copied":"Copied to clipboard!","toast.exported":"records exported.","toast.verified":"records re-verified.","shortcuts.title":"Keyboard Shortcuts","search.placeholder":"Search records, vault, tools, documents...","search.noResults":"No results found"}},setLocale:function(e){this.locale=e},t:function(e){var t;return(this.catalogs[this.locale]||this.catalogs.en)[e]||this.catalogs.en[e]||e}},window.S4.t=S4.i18n.t.bind(S4.i18n);var e=[],t=null;function n(){if(0!==e.length){var t=e.splice(0,20);try{var n=localStorage.getItem("s4_session_id")||"unknown";navigator.sendBeacon("/api/errors/report",JSON.stringify({session_id:n,errors:t}))}catch(r){}}}if(window.onerror=function(r,o,a,s,i){return void 0,e.push({type:"js",msg:String(r).substring(0,500),source:o,line:a,col:s,ts:Date.now()}),clearTimeout(t),t=setTimeout(n,5e3),!0},window.addEventListener("unhandledrejection",function(r){void 0,e.push({type:"promise",msg:String(r.reason).substring(0,500),ts:Date.now()}),clearTimeout(t),t=setTimeout(n,5e3)}),window.addEventListener("error",function(r){r.target&&r.target!==window&&(void 0,e.push({type:"resource",tag:r.target.tagName,url:(r.target.src||r.target.href||"").substring(0,300),ts:Date.now()}),clearTimeout(t),t=setTimeout(n,5e3))},!0),function(){var e=document.createElement("div");S4.sanitize=function(t){return"string"!=typeof t?"":(e.textContent=t,e.innerHTML)},S4.sanitizeHTML=function(e){if("string"!=typeof e)return"";var t=document.createElement("div");t.innerHTML=e;for(var n=t.querySelectorAll("script,iframe,object,embed,form"),r=n.length-1;r>=0;r--)n[r].remove();for(var o=t.querySelectorAll("*"),a=0;a<o.length;a++)for(var s=o[a].attributes,i=s.length-1;i>=0;i--)(s[i].name.startsWith("on")||0===s[i].value.indexOf("javascript:"))&&o[a].removeAttribute(s[i].name);return t.innerHTML};var t=18e5,n=168e4,r=null,o=null,a=!1;function s(){a||(clearTimeout(r),clearTimeout(o),o=setTimeout(function(){a||"function"!=typeof s4Notify||s4Notify("Session Expiring","Your session will lock in 2 minutes due to inactivity. Move your mouse or press a key to stay active.","warning")},n),r=setTimeout(function(){a=!0,S4.sessionLocked=!0;var e=document.getElementById("s4SessionLockOverlay");e&&(e.style.display="flex"),"function"==typeof s4Notify&&s4Notify("Session Locked","Inactive for 30 minutes. Click to resume.","warning")},t))}S4.sessionTimeout=t,S4.resumeSession=function(){a=!1,S4.sessionLocked=!1;var e=document.getElementById("s4SessionLockOverlay");e&&(e.style.display="none"),s()},["mousemove","mousedown","keydown","scroll","touchstart"].forEach(function(e){document.addEventListener(e,s,{passive:!0})}),s();var i=null;S4.crypto={_getKey:async function(){if(i)return i;var e=sessionStorage.getItem("s4_enc_key");if(e){var t=Uint8Array.from(atob(e),function(e){return e.charCodeAt(0)});return i=await crypto.subtle.importKey("raw",t,"AES-GCM",!0,["encrypt","decrypt"])}i=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);var n=await crypto.subtle.exportKey("raw",i);return sessionStorage.setItem("s4_enc_key",btoa(String.fromCharCode.apply(null,new Uint8Array(n)))),i},encrypt:async function(e){var t=await this._getKey(),n=crypto.getRandomValues(new Uint8Array(12)),r=(new TextEncoder).encode(e),o=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,r),a=new Uint8Array(n.length+o.byteLength);return a.set(n),a.set(new Uint8Array(o),n.length),btoa(String.fromCharCode.apply(null,a))},decrypt:async function(e){var t=await this._getKey(),n=Uint8Array.from(atob(e),function(e){return e.charCodeAt(0)}),r=n.slice(0,12),o=n.slice(12),a=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},t,o);return(new TextDecoder).decode(a)}},S4.auditChain={computeChainHash:async function(e,t){var n=(t||"0".repeat(64))+"|"+e.hash+"|"+e.timestamp,r=(new TextEncoder).encode(n),o=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(o)).map(function(e){return e.toString(16).padStart(2,"0")}).join("")},verifyChain:async function(e){if(!e||0===e.length)return{valid:!0,errors:[]};for(var t=[],n="0".repeat(64),r=0;r<e.length;r++)if(e[r].chainHash){var o=await this.computeChainHash(e[r],n);e[r].chainHash!==o&&t.push({index:r,expected:o,got:e[r].chainHash,record:e[r].label||e[r].type}),n=e[r].chainHash}else n=e[r].hash||n;return{valid:0===t.length,errors:t}}};var l={};S4.rateLimit=function(e,t){t=t||30;var n=Date.now();return l[e]||(l[e]=[]),l[e]=l[e].filter(function(e){return n-e<6e4}),!(l[e].length>=t)&&(l[e].push(n),!0)},S4.csrf=function(){var e=null;function t(){var e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,function(e){return e.toString(16).padStart(2,"0")}).join("")}return{getToken:function(){return e||(e=t()),e},refresh:function(){return e=t()},validate:function(t){return t&&t===e},addToHeaders:function(e){return(e=e||{})["X-CSRF-Token"]=this.getToken(),e}}}(),S4.zkVerify=async function(e){var t="undefined"!=typeof s4Vault&&s4Vault.some(function(t){return t.hash===e}),n={timestamp:(new Date).toISOString(),claim:"Record with hash prefix "+e.substring(0,8)+"... exists in vault",verified:t,proofHash:null},r=crypto.getRandomValues(new Uint8Array(16)),o=(new TextEncoder).encode(JSON.stringify(n)+Array.from(r).join("")),a=await crypto.subtle.digest("SHA-256",o);return n.proofHash=Array.from(new Uint8Array(a)).map(function(e){return e.toString(16).padStart(2,"0")}).join(""),n},S4.register("security",{version:"1.0.0",features:["xss-sanitizer","session-timeout","encrypted-storage","audit-chain","rate-limiter","zk-verify"]})}(),"1"===sessionStorage.getItem("s4_entered")){var r=document.getElementById("platformLanding"),o=document.querySelector(".hero"),a=document.getElementById("platformWorkspace");r&&(r.style.display="none"),o&&(o.style.display="none"),a&&(a.style.display="block")}window.addEventListener("scroll",function(){var e=window.scrollY,t=document.documentElement.scrollHeight-window.innerHeight,n=document.getElementById("scrollProgress");n&&(n.style.width=(t>0?e/t*100:0)+"%");var r=document.getElementById("backToTop");r&&(e>400?(r.style.opacity="1",r.style.visibility="visible"):(r.style.opacity="0",r.style.visibility="hidden"))});var s=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&e.target.classList.add("visible")})},{threshold:.1});function i(){const e=JSON.parse(localStorage.getItem("s4_wallet")||"null"),t=document.getElementById("walletNoWallet"),n=document.getElementById("walletCredentials");if(!e||!e.wallet)return t&&(t.style.display="block"),n&&(n.style.display="none"),void 0;t&&(t.style.display="none"),n&&(n.style.display="block"),document.getElementById("walletAddress").textContent=e.wallet.address,document.getElementById("seedRevealed").textContent=e.wallet.seed;const r="mainnet"===e.wallet.network?"https://livenet.xrpl.org/accounts/":"https://testnet.xrpl.org/accounts/";document.getElementById("walletExplorer").href=r+e.wallet.address,l(e.wallet.address)}async function l(e){try{const t=await fetch("/api/wallet/balance?address="+encodeURIComponent(e)),n=await t.json();if(n.error)return document.getElementById("walletSLSBalance").textContent="0",document.getElementById("walletAnchors").textContent="0",document.getElementById("walletXRP").textContent="0",void 0;document.getElementById("walletSLSBalance").textContent=parseFloat(n.sls_balance).toLocaleString(),document.getElementById("walletSLSUSD").textContent=(parseFloat(n.sls_balance)*n.sls_price_usd).toFixed(2),document.getElementById("walletAnchors").textContent=n.anchors_available.toLocaleString(),document.getElementById("walletXRP").textContent=n.xrp_balance.toFixed(2),document.getElementById("walletNetwork").textContent="XRPL "+n.network.charAt(0).toUpperCase()+n.network.slice(1)}catch(t){void 0}}function c(){const e=document.getElementById("seedMasked"),t=document.getElementById("seedRevealed"),n=document.getElementById("seedToggleBtn");"none"===t.style.display?(t.style.display="inline",e.style.display="none",n.innerHTML='<i class="fas fa-eye-slash"></i> Hide'):(t.style.display="none",e.style.display="inline",n.innerHTML='<i class="fas fa-eye"></i> Show')}function d(e){const t=document.getElementById(e).textContent;navigator.clipboard.writeText(t).then(()=>{const t=document.getElementById(e).parentElement.querySelector("button"),n=t.innerHTML;t.innerHTML='<i class="fas fa-check"></i>',setTimeout(()=>{t.innerHTML=n},1200)})}function u(e,t){document.getElementById("slsUsdInput").value=e,y(),document.querySelectorAll(".sls-amt-btn").forEach(e=>{e.style.borderColor="var(--border)",e.style.background="var(--surface)",e.style.color="var(--steel)"}),t&&(t.style.borderColor="rgba(0,170,255,0.5)",t.style.background="rgba(0,170,255,0.08)",t.style.color="var(--accent)")}function y(){const e=parseFloat(document.getElementById("slsUsdInput").value)||0,t=Math.round(e/.01);document.getElementById("slsPreviewTokens").textContent=t.toLocaleString()+" Credits",document.getElementById("slsPreviewAnchors").textContent=(100*t).toLocaleString()}async function f(){const e=JSON.parse(localStorage.getItem("s4_wallet")||"null"),t=document.getElementById("buySLSResult"),n=document.getElementById("buySLSBtn");if(!e||!e.wallet)return t.style.display="block",t.style.background="rgba(255,51,51,0.08)",t.style.border="1px solid rgba(255,51,51,0.2)",t.style.color="#ff6b6b",t.innerHTML='<i class="fas fa-exclamation-circle" style="margin-right:6px"></i>Please <a href="/s4-login/" style="color:var(--accent)">create an account</a> first to get a wallet.',void 0;const r=parseFloat(document.getElementById("slsUsdInput").value)||0;if(r<=0)return t.style.display="block",t.style.background="rgba(255,51,51,0.08)",t.style.border="1px solid rgba(255,51,51,0.2)",t.style.color="#ff6b6b",t.textContent="Please enter a valid amount.",void 0;n.disabled=!0,n.innerHTML='<i class="fas fa-spinner fa-spin"></i> Processing...',t.style.display="none";try{const n=await fetch("/api/wallet/buy-sls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wallet_address:e.wallet.address,usd_amount:r,payment_method:"card"})}),o=await n.json();o.error?(t.style.display="block",t.style.background="rgba(255,51,51,0.08)",t.style.border="1px solid rgba(255,51,51,0.2)",t.style.color="#ff6b6b",t.innerHTML='<i class="fas fa-exclamation-circle" style="margin-right:6px"></i>'+o.error):(t.style.display="block",t.style.background="rgba(0,170,255,0.2)",t.style.border="1px solid rgba(0,170,255,0.2)",t.style.color="#00aaff",t.innerHTML='<i class="fas fa-check-circle" style="margin-right:6px"></i>Purchased '+parseFloat(o.purchase.sls_received).toLocaleString()+" Credits for $"+o.purchase.usd_paid.toFixed(2)+'! <a href="'+o.explorer_url+'" target="_blank" style="color:var(--accent);margin-left:8px">View TX <i class="fas fa-external-link-alt" style="font-size:0.7rem"></i></a>',l(e.wallet.address))}catch(o){t.style.display="block",t.style.background="rgba(255,51,51,0.08)",t.style.border="1px solid rgba(255,51,51,0.2)",t.style.color="#ff6b6b",t.innerHTML='<i class="fas fa-exclamation-circle" style="margin-right:6px"></i>Network error: '+o.message}n.disabled=!1,n.innerHTML='<i class="fas fa-credit-card" style="margin-right:6px"></i> Purchase with Card'}function p(e){document.querySelectorAll(".chart-range-btn").forEach(e=>{e.style.background="var(--surface)",e.style.border="1px solid var(--border)",e.style.color="var(--steel)",e.style.fontWeight="400"});const t=document.getElementById("chart"+e.charAt(0).toUpperCase()+e.slice(1));t&&(t.style.background="rgba(26,58,92,0.2)",t.style.border="1px solid rgba(201,168,76,0.3)",t.style.color="#00aaff",t.style.fontWeight="700");const n=document.getElementById("chartOverlay");n&&(n.querySelector("p").textContent="Showing "+e+" usage data. Chart populates as records are anchored.")}document.querySelectorAll(".reveal-anim").forEach(function(e){s.observe(e)}),setTimeout(function(){var e=document.getElementById("platformWorkspace");e&&"block"===e.style.display&&"function"==typeof loadPerformanceMetrics&&loadPerformanceMetrics().catch(function(e){void 0})},2e3),document.addEventListener("shown.bs.tab",function(e){"#tabWallet"===e.target.getAttribute("href")&&i()}),"#tabWallet"===window.location.hash&&document.addEventListener("DOMContentLoaded",()=>setTimeout(i,500)),window.copyWalletField=d,window.handleBuySLS=f,window.setChartRange=p,window.setSLSAmount=u,window.toggleSeed=c,window.updateSLSPreview=y;
