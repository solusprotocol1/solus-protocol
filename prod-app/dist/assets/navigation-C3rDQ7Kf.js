var e=0,t=localStorage.getItem("s4_selected_tier")||"starter",o={pilot:{label:"Pilot (Free)",credits:100,price:"Free"},starter:{label:"Starter ($999/mo)",credits:25e3,price:"$999/mo"},professional:{label:"Professional ($2,499/mo)",credits:1e5,price:"$2,499/mo"},enterprise:{label:"Enterprise ($9,999/mo)",credits:5e5,price:"$9,999/mo"}},n;function a(){var t=document.getElementById("onboardOverlay");t&&(t.style.display="flex","function"==typeof _s4TrapFocus&&_s4TrapFocus(t)),e=0,s()}function r(){var e=document.getElementById("onboardOverlay");e&&(e.style.display="none"),"function"==typeof _s4ReleaseFocusTrap&&_s4ReleaseFocusTrap(),sessionStorage.setItem("s4_onboard_done","1");var n=o[t]||o.starter;localStorage.setItem("s4_selected_tier",t),"function"==typeof showRoleSelector?showRoleSelector():"function"==typeof window.showRoleSelector&&window.showRoleSelector()}function i(){if(++e>4)return r(),void 0;s(),1===e&&l(),2===e&&c()}function s(){for(var t=0;t<=4;t++){var o=document.getElementById("onboardStep"+t);o&&o.classList.toggle("active",t===e)}var n;document.querySelectorAll("#onboardProgress .onboard-dot").forEach(function(t,o){t.classList.remove("active","done"),o===e?t.classList.add("active"):o<e&&t.classList.add("done")})}function l(){var e=document.getElementById("onboardAcctStatus"),t=document.getElementById("onboardAcctId"),o=document.getElementById("onboardAcctDone");t&&(t.textContent="acct_"+Date.now().toString(36)),setTimeout(function(){e&&(e.innerHTML='<i class="fas fa-check-circle" style="color:var(--green)"></i> Active'),o&&(o.style.display="block")},1200)}function c(){for(var e=document.getElementById("onboardWalletAddr"),t=document.getElementById("onboardXrpBal"),o=document.getElementById("onboardTrustLine"),n=document.getElementById("onboardWalletDone"),a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r="r",i=0;i<28;i++)r+=a[Math.floor(62*Math.random())];setTimeout(function(){e&&(e.textContent=r.substring(0,8)+"..."+r.slice(-4))},500),setTimeout(function(){t&&(t.textContent="12.000000 XRP")},1200),setTimeout(function(){o&&(o.innerHTML='Credits <i class="fas fa-check-circle" style="color:var(--green);margin-left:4px"></i>'),n&&(n.style.display="block")},1800)}function d(e,n){t=n;var a=o[n]||o.starter;window._s4TierAllocation=a.credits,window._s4TierLabel=a.label,localStorage.setItem("s4_tier_allocation",String(a.credits)),localStorage.setItem("s4_tier_label",a.label),document.querySelectorAll(".onboard-tier").forEach(function(e){e.classList.remove("selected")}),e.classList.add("selected");var r=document.getElementById("onboardSlsBal"),i=document.getElementById("onboardSlsAnchors");r&&(r.textContent=a.credits.toLocaleString()),i&&(i.textContent=(100*a.credits).toLocaleString());var s=document.getElementById("slsBarBalance");s&&(s.textContent=a.credits.toLocaleString()+" Credits");var l=document.getElementById("toolSlsBal");l&&(l.textContent=a.credits.toLocaleString());var c=document.getElementById("sidebarSlsBal");c&&(c.textContent=a.credits.toLocaleString()+" Credits");var d=document.getElementById("walletSLSBalance");d&&(d.textContent=a.credits.toLocaleString());var u=document.getElementById("slsBarPlan");u&&(u.textContent=a.label.replace(/\s*\(.*\)/,""));var m=document.getElementById("walletTriggerBal");m&&(m.textContent=a.credits.toLocaleString()+" Credits")}n=o[t]||o.starter,window._s4TierAllocation=n.credits,window._s4TierLabel=n.label,void(localStorage.getItem("s4_tier_allocation")?(window._s4TierAllocation=parseInt(localStorage.getItem("s4_tier_allocation"))||n.credits,window._s4TierLabel=localStorage.getItem("s4_tier_label")||n.label):(localStorage.setItem("s4_tier_allocation",String(n.credits)),localStorage.setItem("s4_tier_label",n.label))),window.showOnboarding=a,window.closeOnboarding=r,window.onboardNext=i,window.selectOnboardTier=d,function e(){function t(){document.querySelectorAll(".onboard-btn").forEach(function(e){e._s4ob||(e._s4ob=!0,e.addEventListener("click",function(e){var t;e.stopPropagation(),-1!==(this.textContent||"").toLowerCase().indexOf("enter")?(sessionStorage.setItem("s4_entered","1"),r()):i()}))}),document.querySelectorAll(".onboard-tier").forEach(function(e){e._s4ob||(e._s4ob=!0,e.addEventListener("click",function(e){var t;e.stopPropagation(),d(this,this.getAttribute("data-tier")||"starter")}))})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t();var o=setInterval(function(){var e=document.getElementById("onboardOverlay");e&&"flex"===e.style.display&&(t(),clearInterval(o))},200);setTimeout(function(){clearInterval(o)},3e4)}(),function e(){if(!sessionStorage.getItem("s4_onboard_done")){var t=0;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){setTimeout(o,200)}):setTimeout(o,200)}function o(){t++;var e=document.getElementById("platformWorkspace");if(e&&"block"===e.style.display&&!sessionStorage.getItem("s4_onboard_done"))return a(),void 0;t<300&&setTimeout(o,100)}}();var u=null,m=null,f;function b(){document.querySelectorAll(".tab-pane").forEach(function(e){e.classList.remove("show","active"),e.style.display="none"});var e=document.getElementById("sectionSystems");e&&(e.style.display="none"),document.querySelectorAll(".ils-hub-panel").forEach(function(e){e.classList.remove("active"),e.style.display="none"});var t=document.getElementById("ilsToolBackBar");t&&(t.style.display="none");var o=document.getElementById("ilsSubHub");o&&(o.style.display="grid");var n=document.querySelector(".ils-hub-tabs");n&&(n.style.display="none"),m=null;var a=document.getElementById("platformHub");a&&(a.style.display="block",a.style.animation="fadeIn 0.3s ease");var r=document.getElementById("statsRow");if(r&&(r.style.display="flex"),!sessionStorage.getItem("s4_entered")){var i=document.querySelector(".hero");i&&(i.style.display="block");var s=document.getElementById("platformLanding");s&&(s.style.display="block")}u=null,history.replaceState(null,"",window.location.pathname)}function p(e){var t=document.getElementById("platformHub");t&&(t.style.display="none");var o=document.querySelector(".hero");o&&(o.style.display="none");var n=document.getElementById("platformLanding");n&&(n.style.display="none"),document.querySelectorAll(".tab-pane").forEach(function(e){e.classList.remove("show","active"),e.style.display="none"});var a=document.getElementById("sectionSystems");a&&(a.style.display="none");var r={sectionAnchor:"tabAnchor",sectionVerify:"tabVerify",sectionLog:"tabLog",sectionILS:"tabILS",sectionSystems:"sectionSystems",sectionMetrics:"tabMetrics",sectionOffline:"tabOffline"};if("sectionSystems"===e)a&&(a.style.display="block",a.classList.add("show","active"),a.style.animation="fadeIn 0.3s ease");else{var i=r[e]||e,s=document.getElementById(i);s&&(s.style.display="block",s.classList.add("show","active"),s.style.animation="fadeIn 0.3s ease");var l=document.querySelector('a[href="#'+i+'"]');if(l)try{new bootstrap.Tab(l).show()}catch(m){}}if(u=e,"sectionILS"===e){var c=document.getElementById("ilsSubHub");c&&(c.style.display="grid");var d=document.getElementById("ilsToolBackBar");d&&(d.style.display="none"),document.querySelectorAll(".ils-hub-panel").forEach(function(e){e.classList.remove("active")})}}function g(e){var t=document.getElementById("sectionSystems");t&&(t.style.display="none");var o=document.getElementById(e);o&&(o.style.display="block",o.classList.add("show","active"),o.style.animation="fadeIn 0.3s ease")}function y(e){var t=document.getElementById("ilsSubHub");t&&(t.style.display="none");var o=document.getElementById("ilsToolBackBar");o&&(o.style.display="block"),document.querySelectorAll(".ils-hub-panel").forEach(function(e){e.classList.remove("active"),e.style.display="none"});var n=document.getElementById(e);n&&(n.style.display="block",n.classList.add("active"),n.style.animation="fadeIn 0.3s ease");var a=document.querySelector('.ils-hub-tab[onclick*="'+e+'"]');a&&(document.querySelectorAll(".ils-hub-tab").forEach(function(e){e.classList.remove("active")}),a.classList.add("active")),"hub-actions"===e&&("function"==typeof renderHubActions&&renderHubActions(),"function"==typeof renderActionCalendar&&(setTimeout(renderActionCalendar,200),setTimeout(renderActionCalendar,600))),"hub-vault"===e&&"function"==typeof renderVault&&renderVault(),"hub-docs"===e&&"function"==typeof renderDocLibrary&&renderDocLibrary(),"hub-compliance"===e&&"function"==typeof calcCompliance&&calcCompliance(),"hub-risk"===e&&"function"==typeof loadRiskData&&loadRiskData(),"hub-roi"===e&&"function"==typeof calcROI&&calcROI(),"hub-reports"===e&&"function"==typeof loadReportPreview&&loadReportPreview(),"hub-predictive"===e&&"function"==typeof loadPredictiveData&&loadPredictiveData(),"hub-submissions"===e&&"function"==typeof loadSubmissionHistory&&loadSubmissionHistory(),"hub-sbom"===e&&"function"==typeof loadSBOMData&&loadSBOMData(),"hub-dmsms"===e&&"function"==typeof loadDMSMSData&&loadDMSMSData(),"hub-readiness"===e&&"function"==typeof loadReadinessData&&loadReadinessData(),"hub-lifecycle"===e&&"function"==typeof calcLifecycle&&calcLifecycle(),"hub-analysis"===e&&"function"==typeof initILSChecklist&&initILSChecklist(),"function"==typeof updateAiContext&&updateAiContext(e),w(e),m=e}function h(){document.querySelectorAll(".ils-hub-panel").forEach(function(e){e.classList.remove("active"),e.style.display="none"});var e=document.getElementById("ilsSubHub");e&&(e.style.display="grid",e.style.animation="fadeIn 0.3s ease");var t=document.getElementById("ilsToolBackBar");t&&(t.style.display="none");var o=document.querySelector(".ils-hub-tabs");if(o&&(o.style.display="none"),m=null,_currentRole&&"function"==typeof applyTabVisibility){var n=_customVisibleTabs||(_s4Roles[_currentRole]?_s4Roles[_currentRole].tabs:_allHubTabs);applyTabVisibility(n)}}function v(){var e=document.getElementById("walletSidebar"),t=document.getElementById("walletOverlay");e&&e.classList.add("open"),t&&t.classList.add("show");var o=document.getElementById("walletSidebarBody"),n=document.getElementById("tabWallet");o&&n&&!o.dataset.loaded&&(o.innerHTML=n.innerHTML,o.dataset.loaded="true","function"==typeof loadWalletData&&loadWalletData(),x(o)),I()}function x(e){var t=e.querySelector("#slsToggleBtn");if(t){t.removeAttribute("onclick");var o=document.createElement("div");o.id="sidebarFlowPanel",o.style.cssText="display:none;margin-top:12px;background:linear-gradient(135deg,rgba(0,170,255,0.06),rgba(201,168,76,0.04));border:1px solid rgba(0,170,255,0.25);border-radius:3px;padding:16px 18px;",o.innerHTML='<div style="position:relative"><div style="position:absolute;top:-4px;right:0;background:linear-gradient(135deg,#00aaff,#c9a84c);padding:3px 12px;border-radius:0 10px 0 8px;font-size:0.62rem;font-weight:700;color:#050810;letter-spacing:0.5px">LIVE PREVIEW</div><h4 style="margin:0 0 4px;font-size:0.95rem;color:#fff"><i class="fas fa-flask" style="color:#00aaff;margin-right:6px"></i>Credit Economic Flow</h4><p style="color:#8ea4b8;font-size:0.72rem;margin:0 0 12px">See how the Credit economy works. <strong style="color:#c9a84c">Every anchor costs 0.01 Credits.</strong></p><div style="display:grid;grid-template-columns:1fr 1fr;gap:8px"><div style="background:rgba(0,170,255,0.08);border:1px solid rgba(0,170,255,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(0,170,255,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-user-plus" style="color:#00aaff;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">1. Account</div><div style="font-size:0.62rem;color:#8ea4b8">Created &amp; provisioned</div></div><div style="background:rgba(0,170,255,0.08);border:1px solid rgba(0,170,255,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(0,170,255,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-wallet" style="color:#00aaff;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">2. Wallet Funded</div><div style="font-size:0.62rem;color:#8ea4b8">12 XRP reserve</div></div><div style="background:rgba(201,168,76,0.08);border:1px solid rgba(201,168,76,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(201,168,76,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-coins" style="color:#c9a84c;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">3. Credits Allocated</div><div style="font-size:0.62rem;color:#8ea4b8">Based on plan tier</div></div><div style="background:rgba(0,170,255,0.08);border:1px solid rgba(0,170,255,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(0,170,255,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-arrow-right" style="color:#00aaff;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">4. 0.01 Credits &rarr; Treasury</div><div style="font-size:0.62rem;color:#8ea4b8">Per anchor fee</div></div></div><div style="margin-top:10px;padding:8px 12px;background:rgba(0,0,0,0.25);border-radius:3px;font-size:0.7rem"><div style="display:flex;justify-content:space-between;flex-wrap:wrap;gap:6px"><div><span style="color:#8ea4b8">Wallet:</span> <span style="color:#00aaff;font-family:monospace" id="sidebarWalletAddr">rMLmk...f1KLqJ</span></div><div><span style="color:#8ea4b8">Balance:</span> <span style="color:#c9a84c;font-weight:700" id="sidebarSlsBal">'+(document.getElementById("slsBarBalance")?document.getElementById("slsBarBalance").textContent:"25,000")+" Credits</span></div></div></div></div>";var n=e.querySelector("#slsBalanceBar");n?n.parentNode.insertBefore(o,n.nextSibling):e.insertBefore(o,e.firstChild?e.firstChild.nextSibling:null);var a=!1;t.addEventListener("click",function(){a=!a,o.style.display=a?"block":"none",t.innerHTML=a?'<i class="fas fa-chevron-up" style="margin-right:4px"></i>Hide Flow Details':'<i class="fas fa-chart-simple" style="margin-right:4px"></i>Show Flow Details'})}}function S(){var e=document.getElementById("walletSidebar"),t=document.getElementById("walletOverlay");e&&e.classList.remove("open"),t&&t.classList.remove("show")}function I(){var e=document.getElementById("slsBarBalance"),t=document.getElementById("walletTriggerBal");e&&t&&(t.textContent=e.textContent||"--")}!function e(){var t="s4_tool_card_order";function o(){return document.getElementById("ilsSubHub")}function n(){var e=o();if(e){var n=localStorage.getItem(t);if(n)try{var a=JSON.parse(n),r=Array.from(e.querySelectorAll(".ils-tool-card")),i={};r.forEach(function(e){var t,o=((e.getAttribute("onclick")||"").match(/openILSTool\('([^']+)'\)/)||[])[1];o&&(i[o]=e)}),a.forEach(function(t){i[t]&&e.appendChild(i[t])})}catch(s){}}}function a(){var e=o();if(e){var n=e.querySelectorAll(".ils-tool-card"),a=[];n.forEach(function(e){var t,o=((e.getAttribute("onclick")||"").match(/openILSTool\('([^']+)'\)/)||[])[1];o&&a.push(o)}),localStorage.setItem(t,JSON.stringify(a))}}function r(){var e=o();if(e){var t=null;e.querySelectorAll(".ils-tool-card").forEach(function(o){o.setAttribute("draggable","true"),o.addEventListener("dragstart",function(e){t=this,this.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain","")}),o.addEventListener("dragend",function(){this.classList.remove("dragging"),e.querySelectorAll(".ils-tool-card").forEach(function(e){e.classList.remove("drag-over")})}),o.addEventListener("dragover",function(e){e.preventDefault(),e.dataTransfer.dropEffect="move",this!==t&&this.classList.add("drag-over")}),o.addEventListener("dragleave",function(){this.classList.remove("drag-over")}),o.addEventListener("drop",function(o){if(o.preventDefault(),this.classList.remove("drag-over"),t&&t!==this){var n=Array.from(e.querySelectorAll(".ils-tool-card")),i,s;n.indexOf(t)<n.indexOf(this)?e.insertBefore(t,this.nextSibling):e.insertBefore(t,this),a(),r()}t=null});var n=null,i=!1,s=null,l=null;o.addEventListener("touchstart",function(e){var t=this;n=setTimeout(function(){i=!0,l=t,t.classList.add("dragging"),(s=t.cloneNode(!0)).style.position="fixed",s.style.pointerEvents="none",s.style.opacity="0.85",s.style.zIndex="9999",s.style.width=t.offsetWidth+"px",s.style.transform="scale(1.05)",s.style.boxShadow="0 8px 32px rgba(0,170,255,0.3)",document.body.appendChild(s)},500)},{passive:!0}),o.addEventListener("touchmove",function(t){if(i&&s){t.preventDefault();var o=t.touches[0];s.style.left=o.clientX-s.offsetWidth/2+"px",s.style.top=o.clientY-s.offsetHeight/2+"px",e.querySelectorAll(".ils-tool-card").forEach(function(e){e.classList.remove("drag-over")});var n=document.elementFromPoint(o.clientX,o.clientY);if(n){var a=n.closest(".ils-tool-card");a&&a!==l&&a.classList.add("drag-over")}}},{passive:!1}),o.addEventListener("touchend",function(t){if(clearTimeout(n),i&&l){var o=t.changedTouches[0],c=document.elementFromPoint(o.clientX,o.clientY),d=c?c.closest(".ils-tool-card"):null;if(d&&d!==l){var u=Array.from(e.querySelectorAll(".ils-tool-card")),m,f;u.indexOf(l)<u.indexOf(d)?e.insertBefore(l,d.nextSibling):e.insertBefore(l,d),a(),r()}l.classList.remove("dragging"),e.querySelectorAll(".ils-tool-card").forEach(function(e){e.classList.remove("drag-over")})}s&&s.parentNode&&s.parentNode.removeChild(s),i=!1,s=null,l=null}),o.addEventListener("touchcancel",function(){clearTimeout(n),s&&s.parentNode&&s.parentNode.removeChild(s),l&&l.classList.remove("dragging"),e.querySelectorAll(".ils-tool-card").forEach(function(e){e.classList.remove("drag-over")}),i=!1,s=null,l=null})})}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){n(),r()}):(n(),r())}(),document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){var e=document.getElementById("platformHub");e&&(e.style.display="block"),document.querySelectorAll(".tab-pane").forEach(function(e){e.classList.remove("show","active"),e.style.display="none"})},100)}),document.addEventListener("shown.bs.tab",function(e){I()}),function(){function e(){var e=document.getElementById("actionItemBadge");if(e){var t=0;"undefined"!=typeof s4ActionItems&&Array.isArray(s4ActionItems)&&(t=s4ActionItems.filter(function(e){return!e.done}).length),t>0?(e.textContent=t,e.style.display="inline-flex"):e.style.display="none"}}setInterval(e,3e3),document.addEventListener("DOMContentLoaded",function(){setTimeout(e,2e3)});var t=p;p=function(o){t(o),setTimeout(e,500)}}(),function(){function e(){var e=document.getElementById("slsBarBalance"),t=document.getElementById("slsBarAnchors"),o=document.getElementById("slsBarSpent"),n=document.getElementById("toolSlsBal"),a=document.getElementById("toolSlsAnch"),r=document.getElementById("toolSlsSpent");n&&e&&(n.textContent=e.textContent.replace(" Credits","")),a&&t&&(a.textContent=t.textContent),r&&o&&(r.textContent=o.textContent.replace(" Credits",""))}setInterval(e,2e3);var t=y;y=function(o){t(o),setTimeout(e,200)}}(),f=hideAnchorAnimation,hideAnchorAnimation=function(){if(f(),m){var e=document.getElementById(m);if(!e)return;var t=e.querySelector(".anchor-confirm-banner");t&&t.remove();var o=s4Vault.length>0?s4Vault[0]:null;if(!o)return;var n=document.createElement("div");n.className="anchor-confirm-banner",n.style.cssText="background:linear-gradient(135deg,rgba(0,204,102,0.08),rgba(0,170,255,0.06));border:1px solid rgba(0,204,102,0.2);border-radius:3px;padding:16px 20px;margin-bottom:16px;animation:panelSlideIn 0.4s ease;position:relative",n.innerHTML='<button onclick="this.parentElement.remove()" style="position:absolute;top:8px;right:12px;background:none;border:none;color:var(--muted);cursor:pointer;font-size:0.85rem">&times;</button><div style="display:flex;align-items:center;gap:8px;margin-bottom:8px"><i class="fas fa-check-circle" style="color:#00cc66;font-size:1.1rem"></i><strong style="color:#fff;font-size:0.9rem">Record Anchored Successfully</strong></div><div style="font-size:0.78rem;color:var(--steel);display:grid;grid-template-columns:80px 1fr;gap:4px 12px"><span style="color:var(--muted)">Type:</span><span>'+(o.label||o.type)+'</span><span style="color:var(--muted)">Hash:</span><span style="font-family:monospace;color:var(--accent);font-size:0.72rem;word-break:break-all">'+(o.hash||"").substring(0,32)+'...</span><span style="color:var(--muted)">TX:</span><span>'+(o.txHash?'<a href="'+(o.explorerUrl||"#")+'" target="_blank" style="color:var(--accent);text-decoration:none">'+o.txHash.substring(0,16)+'... <i class="fas fa-external-link-alt" style="font-size:0.6rem"></i></a>':"Pending")+'</span><span style="color:var(--muted)">Fee:</span><span style="color:#c9a84c">0.01 Credits</span><span style="color:var(--muted)">Time:</span><span>'+(new Date).toLocaleTimeString()+"</span></div>";var a=e.querySelector(".s4-card");a&&a.insertBefore(n,a.firstChild),setTimeout(function(){n.parentElement&&n.remove()},15e3)}},window.closeILSTool=h,window.closeWalletSidebar=S,window.openILSTool=y,window.openWalletSidebar=v,window.showHub=b,window.showSection=p,window.showSystemsSub=g;var E=["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team","tabAnchor","tabVerify"];function k(e){var t=document.querySelector(".hiw-modal-overlay");t&&t.remove();var o=e.querySelector("summary")?e.querySelector("summary").textContent.replace(/[▸▾▾]/g,"").trim():"How It Works",n="";e.querySelectorAll("p,ol,ul,li").forEach(function(e){n+=e.outerHTML}),n||(n=e.innerHTML.replace(/<summary[^>]*>.*?<\/summary>/i,""));var a=document.createElement("div");a.className="hiw-modal-overlay",a.innerHTML='<div class="hiw-modal-box"><button class="hiw-close" title="Close">&times;</button><h4><i class="fas fa-info-circle" style="margin-right:6px"></i>'+o+'</h4><div class="hiw-body">'+n+"</div></div>",a.querySelector(".hiw-close").onclick=function(){a.remove()},a.onclick=function(e){e.target===a&&a.remove()},document.body.appendChild(a)}function w(e){var t=document.getElementById(e);if(t){var o=t.querySelector("details");if(o){o.style.display="none";var n=t.querySelector("h3")||t.querySelector("h4")||t.querySelector(".hub-tool-header h4")||t.querySelector("h5");if(n&&!n.querySelector(".hiw-help-btn")){var a=document.createElement("button");a.className="hiw-help-btn",a.title="How It Works",a.textContent="?",a.style.cssText="margin-left:8px;background:rgba(0,170,255,0.12);border:1px solid rgba(0,170,255,0.3);color:#00aaff;border-radius:50%;width:24px;height:24px;font-size:0.75rem;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;flex-shrink:0;",a.onclick=function(e){e.stopPropagation(),k(o)},n.appendChild(a)}}}}!function e(){function t(){E.forEach(function(e){w(e)})}if(t(),setTimeout(t,500),setTimeout(t,2e3),"undefined"!=typeof MutationObserver){var o=new MutationObserver(function(e){var t=!1;e.forEach(function(e){"childList"===e.type&&e.removedNodes.length>0&&e.removedNodes.forEach(function(e){e.classList&&e.classList.contains("hiw-help-btn")&&(t=!0),e.querySelector&&e.querySelector(".hiw-help-btn")&&(t=!0)})}),t&&setTimeout(function(){E.forEach(w)},50)});E.forEach(function(e){var t=document.getElementById(e);t&&o.observe(t,{childList:!0,subtree:!0})})}}(),function e(){function t(){document.querySelectorAll(".hub-card[data-section]").forEach(function(e){e._s4bound||(e._s4bound=!0,e.addEventListener("click",function(e){var t=this.getAttribute("data-section");t&&"function"==typeof p&&p(t)}))})}t(),"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",t)}();var L={ils_manager:{label:"ILS Manager",icon:"fa-clipboard-list",desc:"Full ILS tool suite access",tabs:["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team"]},dmsms_analyst:{label:"DMSMS Analyst",icon:"fa-microchip",desc:"DMSMS tracking and obsolescence management",tabs:["hub-dmsms","hub-risk","hub-lifecycle","hub-actions","hub-vault","hub-docs","hub-reports"]},auditor:{label:"Auditor / Compliance",icon:"fa-shield-halved",desc:"Compliance scorecard and audit vault",tabs:["hub-compliance","hub-vault","hub-actions","hub-docs","hub-reports","hub-submissions"]},contracts:{label:"Contract Specialist",icon:"fa-file-contract",desc:"ROI, submissions, and document management",tabs:["hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-actions","hub-cdrl","hub-contract"]},supply_chain:{label:"Supply Chain / Provisioning",icon:"fa-truck",desc:"Supply, readiness, and provisioning tools",tabs:["hub-readiness","hub-risk","hub-lifecycle","hub-actions","hub-vault","hub-docs","hub-submissions"]},admin:{label:"Full Access Admin",icon:"fa-user-shield",desc:"All tools visible — unrestricted access",tabs:["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team"]}},C=["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team"],B={"hub-analysis":"Gap Analysis","hub-dmsms":"DMSMS Tracker","hub-readiness":"Readiness Calc","hub-compliance":"Compliance","hub-risk":"Supply Chain Risk","hub-actions":"Action Items","hub-predictive":"Predictive Maint","hub-lifecycle":"Lifecycle Cost","hub-roi":"ROI Calculator","hub-vault":"Audit Vault","hub-docs":"Document Library","hub-reports":"Report Gen","hub-submissions":"Submissions & PTD","hub-sbom":"SBOM Viewer","hub-gfp":"GFP Tracker","hub-cdrl":"CDRL Validator","hub-contract":"Contract Extractor","hub-provenance":"Provenance Chain","hub-analytics":"Cross-Program Analytics","hub-team":"Team Management"},T=sessionStorage.getItem("s4_user_role")||"",A=sessionStorage.getItem("s4_user_title")||"",M=JSON.parse(sessionStorage.getItem("s4_visible_tabs")||"null");function R(){var e=document.getElementById("roleModal");e&&e.remove();var t=document.createElement("div");t.id="roleModal",t.style.cssText="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:10000;display:flex;align-items:center;justify-content:center;animation:fadeIn 0.3s ease";var o=document.createElement("div");o.style.cssText="background:#0d1117;border:1px solid rgba(255,255,255,0.12);border-radius:3px;padding:32px;max-width:620px;width:95%;max-height:85vh;overflow-y:auto",o.innerHTML='<h3 style="color:#fff;margin:0 0 4px"><i class="fas fa-user-cog" style="color:#00aaff;margin-right:8px"></i>Configure Your Role</h3><p style="color:#8b949e;font-size:0.85rem;margin-bottom:20px">Select your role to see relevant tools. You can customize visible tools and your displayed title.</p><div style="margin-bottom:16px"><label style="color:#8b949e;font-size:0.8rem;font-weight:600">Your Display Title</label><input id="roleTitle" value="'+(A||"")+'" style="background:#0a0e1a;color:#fff;border:1px solid rgba(255,255,255,0.15);border-radius:3px;padding:10px;width:100%;margin-top:4px;box-sizing:border-box" placeholder="e.g., ILS Analyst, Logistics Specialist, Contract Manager"></div>';var n=document.createElement("div");n.style.cssText="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px";for(var a=Object.keys(L),r=0;r<a.length;r++)(function(e){var t=L[e],o=T===e,a=document.createElement("div");a.className="role-card",a.setAttribute("data-role",e),a.style.cssText="border:2px solid "+(o?"#00aaff":"rgba(255,255,255,0.12)")+";border-radius:3px;padding:14px;cursor:pointer;transition:all 0.2s;user-select:none;"+(o?"background:rgba(0,170,255,0.15);box-shadow:0 0 12px rgba(0,170,255,0.2)":""),a.innerHTML='<div style="display:flex;align-items:center;gap:8px;margin-bottom:6px;pointer-events:none"><i class="fas '+t.icon+'" style="color:#00aaff;font-size:1.1rem"></i><strong style="color:#fff;font-size:0.9rem">'+t.label+'</strong></div><div style="color:#8b949e;font-size:0.78rem;pointer-events:none">'+t.desc+'</div><div style="color:#6e7681;font-size:0.72rem;margin-top:4px;pointer-events:none">'+t.tabs.length+" tools</div>",a.addEventListener("click",function(t){t.stopPropagation(),_(e)}),n.appendChild(a)})(a[r]);o.appendChild(n);for(var i='<details style="margin-bottom:20px;background:rgba(0,170,255,0.03);border:1px solid rgba(0,170,255,0.12);border-radius:3px;padding:0 16px"><summary style="cursor:pointer;color:#00aaff;font-weight:600;font-size:0.85rem;padding:12px 0;list-style:none;display:flex;align-items:center;gap:8px"><i class="fas fa-sliders-h"></i> Customize Visible Tools <i class="fas fa-chevron-down" style="font-size:0.7rem;margin-left:auto;opacity:0.5"></i></summary><div id="roleToolChecks" style="display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:0 0 16px">',s=0;s<C.length;s++){var l=C[s],c;i+='<label style="display:flex;align-items:center;gap:8px;font-size:0.82rem;color:#8b949e;cursor:pointer;padding:6px 10px;border-radius:3px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.06);transition:all 0.2s"><input type="checkbox" data-tab="'+l+'" '+((M?M.indexOf(l)>=0:!T||(L[T]?.tabs||[]).indexOf(l)>=0)?"checked":"")+' style="accent-color:#00aaff;width:16px;height:16px;flex-shrink:0"> <span>'+(B[l]||l)+"</span></label>"}i+="</div></details>";var d=document.createElement("div");d.innerHTML=i,o.appendChild(d.firstElementChild);var u=document.createElement("div");u.style.cssText="display:flex;gap:10px;justify-content:flex-end";var m=document.createElement("button");m.textContent="Cancel",m.style.cssText="background:rgba(255,255,255,0.06);color:#8b949e;border:1px solid rgba(255,255,255,0.12);border-radius:3px;padding:8px 20px;cursor:pointer",m.addEventListener("click",function(e){e.stopPropagation(),t.remove()});var f=document.createElement("button");f.textContent="Apply Role",f.style.cssText="background:#00aaff;color:#fff;border:none;border-radius:3px;padding:8px 24px;cursor:pointer;font-weight:600",f.addEventListener("click",function(e){e.stopPropagation(),z()}),u.appendChild(m),u.appendChild(f),o.appendChild(u),t.appendChild(o),t.addEventListener("change",function(e){e.target&&e.target.matches&&e.target.matches('#roleToolChecks input[type="checkbox"]')&&O()}),document.body.appendChild(t)}function _(e){T=e;for(var t=document.querySelectorAll("#roleModal .role-card"),o=0;o<t.length;o++)t[o].style.borderColor="rgba(255,255,255,0.12)",t[o].style.background="",t[o].style.boxShadow="";var n=document.querySelector('#roleModal .role-card[data-role="'+e+'"]');n&&(n.style.borderColor="#00aaff",n.style.background="rgba(0,170,255,0.15)",n.style.boxShadow="0 0 12px rgba(0,170,255,0.2)");for(var a=L[e].tabs,r=document.querySelectorAll('#roleToolChecks input[type="checkbox"]'),i=0;i<r.length;i++)r[i].checked=a.indexOf(r[i].dataset.tab)>=0;var s=document.getElementById("roleTitle");s&&!s.value&&(s.value=L[e].label)}function O(){M=[],document.querySelectorAll('#roleToolChecks input[type="checkbox"]').forEach(function(e){e.checked&&M.push(e.dataset.tab)})}function z(){var e=document.getElementById("roleTitle")?.value?.trim()||"",t;A=e,sessionStorage.setItem("s4_user_role",T),sessionStorage.setItem("s4_user_title",A),M?(t=M,sessionStorage.setItem("s4_visible_tabs",JSON.stringify(M))):T&&L[T]?(t=L[T].tabs,sessionStorage.removeItem("s4_visible_tabs")):t=C,q(t),P(),"function"==typeof reloadVaultForRole&&reloadVaultForRole(),document.getElementById("roleModal")?.remove(),"function"==typeof s4Notify&&s4Notify("Role Applied",(e||L[T]?.label||"Custom")+" — "+t.length+" tools active","success")}function q(e){document.querySelectorAll(".ils-hub-tab").forEach(function(t){var o,n=(t.getAttribute("onclick")||"").match(/switchHubTab\('([^']+)'/);if(n){var a=n[1];t.style.display=e.indexOf(a)>=0?"":"none"}}),document.querySelectorAll(".ils-tool-card[onclick]").forEach(function(t){var o,n=(t.getAttribute("onclick")||"").match(/openILSTool\('([^']+)'/);n&&(t.style.display=e.indexOf(n[1])>=0?"":"none")})}function P(){var e=document.getElementById("roleBadge");if(!e){var t=document.querySelector(".ils-hub-tabs")?.previousElementSibling;if(!t)return;var o=t.querySelector("div:last-child");if(!o)return;(e=document.createElement("span")).id="roleBadge",e.style.cssText="display:inline-flex;align-items:center;gap:6px;padding:5px 12px;border-radius:3px;font-size:0.75rem;font-weight:600;background:rgba(0,170,255,0.1);border:1px solid rgba(0,170,255,0.25);color:#00aaff;cursor:pointer;transition:all 0.2s;hover:background:rgba(0,170,255,0.2)",e.title="Click to change your role",e.onclick=R,o.appendChild(e)}var n=T?L[T]?.icon||"fa-user":"fa-user-cog",a=A||(T?L[T]?.label:"Set Role");e.innerHTML='<i class="fas '+n+'"></i> '+a+' <i class="fas fa-gear" style="font-size:0.6rem;opacity:0.6"></i>'}function D(){var e;T&&(q(M||(L[T]?L[T].tabs:C)),"function"==typeof reloadVaultForRole&&reloadVaultForRole());P(),T||setTimeout(function(){var e=document.getElementById("platformWorkspace");e&&"block"===e.style.display&&sessionStorage.getItem("s4_onboard_done")&&R()},2500)}!function(){function e(e){return Math.round(e).toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",")}function t(){try{var t=function(e){var t=document.getElementById(e);return t&&parseFloat(t.value)||0},o=t("roiPrograms"),n=t("roiRecords"),a=t("roiFTEs"),r=t("roiRate"),i=t("roiAudit"),s=t("roiError"),l=t("roiIncidents"),c=t("roiLicense"),d=o*n,u=1+Math.sqrt(Math.max(0,d))/50,m,f,b=.65*(2080*a*r)*u,p=l*s*.9,g=.7*i*Math.max(1,o/5),y=d>0?b/12/d:0,h=b+p+g,v=h-c,x=c>0?v/c*100:0,S=h>0?Math.ceil(c/h*12):0,I=5*h-5*c,E=function(e,t,o){var n=document.getElementById(e);n&&(n.textContent=t,o&&(n.style.color=o))};E("roiSavings","$"+e(v),v>0?"#00cc66":"#ff4444"),E("roiPercent",x.toFixed(0)+"%",x>0?"#00cc66":"#ff4444"),E("roiPayback",S+" mo",null),E("roi5Year","$"+e(I),I>0?"#00cc66":"#ff4444");var k=document.getElementById("roiOutput");k&&(k.innerHTML='<div style="background:var(--surface);border:1px solid var(--border);border-radius:3px;padding:20px;margin-top:12px"><div class="section-label"><i class="fas fa-chart-line"></i> ROI BREAKDOWN</div><div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;font-size:0.85rem;margin-bottom:16px"><div><span style="color:var(--steel)">Labor Automation (65%)</span><br><strong style="color:#00cc66">$'+e(b)+'</strong></div><div><span style="color:var(--steel)">Error Reduction (90%)</span><br><strong style="color:#00cc66">$'+e(p)+'</strong></div><div><span style="color:var(--steel)">Audit Cost Reduction (70%)</span><br><strong style="color:#00cc66">$'+e(g)+'</strong></div><div><span style="color:var(--steel)">S4 Ledger License</span><br><strong style="color:#ff6b6b">-$'+e(c)+'</strong></div></div><hr style="border-color:var(--border);margin:12px 0"><div style="display:flex;justify-content:space-between;align-items:center"><div><span style="color:var(--steel);font-size:0.82rem">Net Annual Savings</span><br><span style="font-size:1.5rem;font-weight:800;color:'+(v>0?"#00cc66":"#ff4444")+'">$'+e(v)+'</span></div><div><span style="color:var(--steel);font-size:0.82rem">Per-Record Savings</span><br><span style="font-size:1.1rem;font-weight:700;color:var(--accent)">$'+y.toFixed(2)+'/record</span></div><div><span style="color:var(--steel);font-size:0.82rem">Volume Multiplier</span><br><span style="font-size:1.1rem;font-weight:700;color:var(--accent)">'+u.toFixed(2)+"x</span></div></div></div>");try{"function"==typeof renderROICharts&&renderROICharts()}catch(w){}}catch(L){void 0}}function o(){var e,o=0;return["roiPrograms","roiRecords","roiFTEs","roiRate","roiAudit","roiError","roiIncidents","roiLicense"].forEach(function(e){var n=document.getElementById(e);n&&(n.removeAttribute("oninput"),n.addEventListener("input",t),o++)}),o>0&&t(),o}function n(){var e={};try{var t=document.querySelectorAll('#ilsCoverage input[type="checkbox"], .ils-checklist input[type="checkbox"]'),o=0,n=t.length||1;t.forEach(function(e){e.checked&&o++}),e.ilsPct=Math.round(o/n*100)}catch(i){e.ilsPct=0}var a=["pctCMMC","pctNIST","pctDFARS","pctFAR","pctILS","pctDMSMSmgmt"];e.comp=a.map(function(e){var t=document.getElementById(e);return t&&parseInt(t.textContent)||0}),e.vault="undefined"!=typeof s4Vault?s4Vault.length:"function"==typeof getLocalRecords?getLocalRecords().length:0,e.actions="undefined"!=typeof s4ActionItems?s4ActionItems.length:0,e.actionsDone=0,"undefined"!=typeof s4ActionItems&&s4ActionItems.forEach(function(t){"done"===t.status&&e.actionsDone++});var r=function(e){var t=document.getElementById(e);return t&&parseFloat(t.value)||0};return e.roiPrograms=r("roiPrograms"),e.roiRecords=r("roiRecords"),e.roiFTEs=r("roiFTEs"),e.roiRate=r("roiRate"),e.roiLicense=r("roiLicense"),e.roiAudit=r("roiAudit"),e.stats="undefined"!=typeof stats?stats:{anchored:0,slsFees:0},e.dmsmsItems="undefined"!=typeof dmsmsItems?dmsmsItems:[],e.riskItems="undefined"!=typeof riskItems?riskItems:[],e}window._s4PatchChartTheme=function e(t){var o;if(!document.body.classList.contains("light-mode"))return t;var n="rgba(0,0,0,0.08)",a="#3a4a5c",r="#2c3e50",i="#2c3e50",s="#2c3e50",l="rgba(0,0,0,0.08)",c="#3a4a5c",d="rgba(255,255,255,0.96)",u="#111",m="#333";if(t.options&&t.options.plugins){var f=t.options.plugins;f.legend&&f.legend.labels&&(f.legend.labels.color=s),f.title&&(f.title.color=i),f.tooltip&&(f.tooltip.backgroundColor&&(f.tooltip.backgroundColor=d),f.tooltip.titleColor&&(f.tooltip.titleColor=u),f.tooltip.bodyColor&&(f.tooltip.bodyColor=m))}if(t.options&&t.options.scales){var b=t.options.scales;Object.keys(b).forEach(function(e){var t=b[e];t.ticks&&(t.ticks.color=a),t.grid&&(t.grid.color=n),t.angleLines&&(t.angleLines.color=l),t.pointLabels&&(t.pointLabels.color=c),t.title&&t.title.display&&(t.title.color=i)})}return t.data&&t.data.datasets&&t.data.datasets.forEach(function(e){"rgba(255,255,255,0.2)"===e.borderColor&&(e.borderColor="rgba(0,0,0,0.2)")}),t},function(){function e(){"undefined"!=typeof Chart&&Chart.register({id:"s4ThemePatch",beforeInit:function(e){if(document.body.classList.contains("light-mode")){var t="rgba(0,0,0,0.08)",o="#3a4a5c",n="#2c3e50";if(e.options&&e.options.scales&&Object.keys(e.options.scales).forEach(function(a){var r=e.options.scales[a];r.ticks&&r.ticks.color&&("#8ea4b8"===r.ticks.color||"#6b7d93"===r.ticks.color)&&(r.ticks.color=o),r.grid&&r.grid.color&&"string"==typeof r.grid.color&&r.grid.color.indexOf("255,255,255")>=0&&(r.grid.color=t),r.angleLines&&r.angleLines.color&&r.angleLines.color.indexOf("255,255,255")>=0&&(r.angleLines.color=t),r.pointLabels&&r.pointLabels.color&&("#8ea4b8"===r.pointLabels.color||"#6b7d93"===r.pointLabels.color)&&(r.pointLabels.color=o),r.title&&r.title.color&&"#8ea4b8"===r.title.color&&(r.title.color=n)}),e.options&&e.options.plugins){var a=e.options.plugins;a.legend&&a.legend.labels&&a.legend.labels.color&&("#8ea4b8"===a.legend.labels.color||"#6b7d93"===a.legend.labels.color)&&(a.legend.labels.color=n),a.title&&"#8ea4b8"===a.title.color&&(a.title.color=n)}}}})}"undefined"!=typeof Chart?e():document.addEventListener("DOMContentLoaded",function(){setTimeout(e,500)})}();var a={gapRadarChart:function(){var e=n(),t=Math.min(100,20+3*e.vault),o=Math.min(100,15+4*e.vault),a=Math.min(100,e.comp[0]||10),r=Math.min(100,10+8*(e.dmsmsItems.length||0)),i=Math.min(100,15+5*(e.riskItems.length||0)),s=Math.min(100,20+.6*e.ilsPct),l=[t,o,a,r,i,s].map(function(e){return Math.min(100,e+30+5*Math.random()|0)});return{type:"radar",data:{labels:["Tracking","Audit","Compliance","Obsolescence","Risk","Budget"],datasets:[{label:"Current (Manual)",data:[t,o,a,r,i,s],borderColor:"#ff6b6b",backgroundColor:"rgba(255,107,107,0.1)",pointBackgroundColor:"#ff6b6b"},{label:"With S4 Ledger",data:l,borderColor:"#00aaff",backgroundColor:"rgba(0,170,255,0.1)",pointBackgroundColor:"#00aaff"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#8ea4b8",font:{size:10}}}},scales:{r:{grid:{color:"rgba(255,255,255,0.06)"},angleLines:{color:"rgba(255,255,255,0.06)"},pointLabels:{color:"#8ea4b8",font:{size:9}},ticks:{display:!1}}}}}},gapBarChart:function(){var e=n(),t,o,a,r,i,s;return{type:"bar",data:{labels:["Tracking","Audit","Compliance","Obsolescence","Risk","Budget"],datasets:[{label:"Gap %",data:[Math.max(0,100-(20+3*e.vault)),Math.max(0,100-(15+4*e.vault)),Math.max(0,100-(e.comp[0]||10)),Math.max(0,100-(10+8*(e.dmsmsItems.length||0))),Math.max(0,100-(15+5*(e.riskItems.length||0))),Math.max(0,100-(20+.6*e.ilsPct))],backgroundColor:["#ff6b6b","#fb923c","#c9a84c","#00aaff","#38bdf8","#06b6d4"],borderWidth:0,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},max:100},y:{ticks:{color:"#8ea4b8",font:{size:9}},grid:{display:!1}}}}}},dmsmsPieChart:function(){var e,t=n().dmsmsItems,o=0,a=0,r=0,i=0,s=0;return t.length>0?t.forEach(function(e){var t=(e.status||"").toLowerCase();t.indexOf("obsolete")>=0?r++:t.indexOf("risk")>=0||t.indexOf("diminish")>=0?a++:t.indexOf("discontin")>=0?i++:t.indexOf("eol")>=0||t.indexOf("last")>=0?s++:o++}):(o=45,a=20,r=15,i=10,s=10),{type:"doughnut",data:{labels:["Active","At Risk","Obsolete","Discontinued","EOL Planned"],datasets:[{data:[o,a,r,i,s],backgroundColor:["#00aaff","#c9a84c","#ff6b6b","#00aaff","#6b7d93"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#8ea4b8",font:{size:9},padding:6}}}}}},readinessGauge:function(){var e=n(),t=Math.max(30,e.ilsPct),o,a,r,i,s,l;return{type:"bar",data:{labels:["Personnel","Equipment","Supply","Training","Maintenance","C4ISR"],datasets:[{label:"Readiness %",data:[Math.min(100,t+15+(e.vault>5?10:0)),Math.min(100,t+(e.dmsmsItems.length>0?-5:8)),Math.min(100,t-12+2*e.vault),Math.min(100,t+20),Math.min(100,t+6+3*e.actionsDone),Math.min(100,t+12)],backgroundColor:"rgba(0,170,255,0.6)",borderColor:"#00aaff",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{ticks:{color:"#8ea4b8",font:{size:9}},grid:{display:!1}},y:{ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},beginAtZero:!0,max:100}}}}},complianceRadarChart:function(){var e=n(),t,o,a,r,i,s;return{type:"polarArea",data:{labels:["DFARS","ITAR","NIST 800-171","CMMC","ISO 27001","SOX"],datasets:[{data:[e.comp[2]||30,Math.min(100,40+4*e.vault),e.comp[1]||25,e.comp[0]||20,Math.min(100,30+.5*e.ilsPct),Math.min(100,35+3*e.vault)],backgroundColor:["rgba(0,170,255,0.5)","rgba(201,168,76,0.5)","rgba(56,189,248,0.5)","rgba(255,107,107,0.5)","rgba(0,170,255,0.5)","rgba(6,182,212,0.5)"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#8ea4b8",font:{size:9},padding:6}}},scales:{r:{grid:{color:"rgba(255,255,255,0.06)"},ticks:{display:!1}}}}}},roiLineChart:function(){var e=n(),t=e.roiPrograms*e.roiRecords,o=1+Math.sqrt(Math.max(0,t))/50,a,r,i,s=.65*(2080*e.roiFTEs*e.roiRate)*o+.7*e.roiAudit*Math.max(1,e.roiPrograms/5),l=e.roiLicense||1,c=[],d=[],u=e.roiPrograms>0||e.roiFTEs>0||e.roiLicense>0;if(u)for(var m=0,f=1;f<=5;f++)for(var b=1;b<=4;b++){c.push("Y"+f+"-Q"+b);var p=4*(f-1)+b,g,y,h;m+=s/4*(.2+.65*(1-Math.exp(-.18*p)))-l/4;var v=l>0?m/l*100:0;d.push(Math.round(v))}if(!u||0===d.length||d.every(function(e){return 0===e})){c=[],d=[];for(var x=1;x<=5;x++)for(var S=1;S<=4;S++){c.push("Y"+x+"-Q"+S);var p=4*(x-1)+S;d.push(Math.round(3.5*p-15+.8*Math.pow(p,1.45)))}}return{type:"line",data:{labels:c,datasets:[{label:"Cumulative ROI %",data:d,borderColor:"#00cc66",backgroundColor:"rgba(0,204,102,0.1)",fill:!0,tension:.3,pointRadius:2,pointBackgroundColor:"#00cc66"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"5-Year Cumulative ROI",color:"#8ea4b8",font:{size:11}}},scales:{x:{ticks:{color:"#8ea4b8",font:{size:8},maxRotation:45},grid:{display:!1}},y:{ticks:{color:"#6b7d93",font:{size:9},callback:function(e){return e+"%"}},grid:{color:"rgba(255,255,255,0.04)"},beginAtZero:!0}}}}},riskHeatChart:function(){var e=n(),t=[];if(e.riskItems.length>0)e.riskItems.forEach(function(e){t.push({x:e.likelihood||Math.ceil(9*Math.random()),y:e.impact||Math.ceil(9*Math.random())})});else for(var o=Math.max(3,Math.min(12,3+e.vault+e.actions)),a=0;a<o;a++)t.push({x:1+Math.floor(9*Math.random()),y:1+Math.floor(9*Math.random())});var r=t.map(function(e){var t=e.x*e.y;return t>=50?"rgba(255,70,70,0.8)":t>=25?"rgba(255,165,0,0.7)":t>=10?"rgba(201,168,76,0.6)":"rgba(0,170,255,0.5)"});return{type:"scatter",data:{datasets:[{label:"Risk Items",data:t,backgroundColor:r,borderColor:r,pointRadius:7}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:t.length+" Risk Items Mapped",color:"#8ea4b8",font:{size:11}}},scales:{x:{title:{display:!0,text:"Likelihood →",color:"#8ea4b8",font:{size:9}},ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},min:0,max:10},y:{title:{display:!0,text:"Impact →",color:"#8ea4b8",font:{size:9}},ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},min:0,max:10}}}}},lifecyclePieChart:function(){var e=n(),t=Math.min(30,5*(e.dmsmsItems.length||0)),o=Math.min(15,.15*e.ilsPct);return{type:"line",data:{labels:["Intro","Growth","Maturity","Sustain","Phase Out","Disposal"],datasets:[{label:"Availability %",data:[95-.1*t,92-.2*t+o,88-.4*t+o,75-.6*t+2*o,50-.3*t+o,20+.5*o].map(function(e){return Math.round(Math.max(5,Math.min(100,e)))}),borderColor:"#00aaff",backgroundColor:"rgba(0,170,255,0.1)",fill:!0,tension:.3},{label:"Cost Index",data:[30,25+.3*t,35+.5*t,55+.8*t-o,70+t-2*o,90+.5*t-o].map(function(e){return Math.round(Math.max(5,Math.min(100,e)))}),borderColor:"#ff6b6b",backgroundColor:"rgba(255,107,107,0.05)",fill:!0,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#8ea4b8",font:{size:10}}}},scales:{x:{ticks:{color:"#8ea4b8",font:{size:9}},grid:{display:!1}},y:{ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},beginAtZero:!0}}}}}};function r(e){if("undefined"==typeof Chart)return void 0,void 0;if("function"==typeof injectChartContainers)try{injectChartContainers()}catch(o){void 0}var t=e.querySelectorAll("canvas");if(0===t.length)return void 0,void 0;t.forEach(function(e){if(!e.getAttribute("data-bp-rendered")){var t=a[e.id];if(!t)return void 0,void 0;try{var o=Chart.getChart(e);o&&o.destroy(),e.style.height||e.getAttribute("height")||(e.style.height="220px"),e.style.width="100%",e.style.display="block";var n=e.closest(".chart-container");n&&(n.style.display="block",n.style.visibility="visible"),new Chart(e,_s4PatchChartTheme(t())),e.setAttribute("data-bp-rendered","1"),e.setAttribute("data-bp-ts",Date.now())}catch(r){void 0}}})}function i(){if(void 0,0===o()&&(setTimeout(o,2e3),setTimeout(o,5e3)),window.calcROI=t,"function"==typeof window.openILSTool){var e=window.openILSTool;window.openILSTool=function(t){e(t),setTimeout(function(){var e=document.getElementById(t);e&&r(e)},300),setTimeout(function(){var e=document.getElementById(t);e&&r(e)},800),setTimeout(function(){var e=document.getElementById(t);e&&r(e)},2e3)}}if("function"==typeof window.switchHubTab){var n=window.switchHubTab;window.switchHubTab=function(e,t){n(e,t),setTimeout(function(){var t=document.getElementById(e);t&&r(t)},400)}}document.querySelectorAll(".ils-hub-panel").forEach(function(e){var t;new MutationObserver(function(e){e.forEach(function(e){e.target.classList&&e.target.classList.contains("active")&&setTimeout(function(){r(e.target)},400)})}).observe(e,{attributes:!0,attributeFilter:["class","style"]})}),setTimeout(function(){document.querySelectorAll(".ils-hub-panel.active").forEach(function(e){r(e)})},2e3),setTimeout(function(){if("function"==typeof loadPerformanceMetrics)try{loadPerformanceMetrics()}catch(e){}},1500),setTimeout(o,3e3),1,D()}window._bpRenderInPanel=r,window._s4RefreshCharts=function(){document.querySelectorAll("canvas[data-bp-rendered]").forEach(function(e){e.removeAttribute("data-bp-rendered")});var e=document.querySelector(".ils-hub-panel.active");e&&r(e)},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i()}(),window.showRoleSelector=R,window.applyRole=z,window.onRoleToolToggle=O,window.selectRolePreset=_;
