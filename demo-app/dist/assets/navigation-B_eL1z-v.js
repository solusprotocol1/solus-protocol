var E=0,U=localStorage.getItem("s4_selected_tier")||"starter",_={pilot:{label:"Pilot (Free)",sls:100,price:"Free"},starter:{label:"Starter ($999/mo)",sls:25e3,price:"$999/mo"},professional:{label:"Professional ($2,499/mo)",sls:1e5,price:"$2,499/mo"},enterprise:{label:"Enterprise ($9,999/mo)",sls:5e5,price:"$9,999/mo"}};function $(){var e=document.getElementById("onboardOverlay");e&&(e.style.display="flex",typeof _s4TrapFocus=="function"&&_s4TrapFocus(e)),E=0,K(),setTimeout(function(){document.querySelectorAll(".onboard-tier").forEach(function(o){o._s4ob||(o._s4ob=!0,o.addEventListener("click",function(r){r.stopPropagation();var a=this.getAttribute("data-tier")||"starter";Y(this,a)}))}),document.querySelectorAll(".onboard-btn").forEach(function(o){o._s4ob||(o._s4ob=!0,o.addEventListener("click",function(r){r.stopPropagation();var a=(this.textContent||"").toLowerCase();a.indexOf("enter")!==-1?(sessionStorage.setItem("s4_entered","1"),H()):j()}))})},50)}function H(){var e=document.getElementById("onboardOverlay");e&&(e.style.display="none"),typeof _s4ReleaseFocusTrap=="function"&&_s4ReleaseFocusTrap(),sessionStorage.setItem("s4_onboard_done","1"),setTimeout(function(){typeof _currentRole<"u"&&!_currentRole&&typeof showRoleSelector=="function"&&showRoleSelector()},500),localStorage.setItem("s4_selected_tier",U),_demoSession=null,typeof _initDemoSession=="function"&&_initDemoSession()}function j(){if(E++,E>4){H();return}K(),E===1&&ae(),E===2&&ie()}function K(){for(var e=0;e<=4;e++){var o=document.getElementById("onboardStep"+e);o&&o.classList.toggle("active",e===E)}var r=document.querySelectorAll("#onboardProgress .onboard-dot");r.forEach(function(a,i){a.classList.remove("active","done"),i===E?a.classList.add("active"):i<E&&a.classList.add("done")})}function ae(){var e=document.getElementById("onboardAcctStatus"),o=document.getElementById("onboardAcctId"),r=document.getElementById("onboardAcctDone");o&&(o.textContent="demo_"+Date.now().toString(36)),setTimeout(function(){e&&(e.innerHTML='<i class="fas fa-check-circle" style="color:var(--green)"></i> Active'),r&&(r.style.display="block")},1200)}function ie(){for(var e=document.getElementById("onboardWalletAddr"),o=document.getElementById("onboardXrpBal"),r=document.getElementById("onboardTrustLine"),a=document.getElementById("onboardWalletDone"),i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",d="r",u=0;u<28;u++)d+=i[Math.floor(Math.random()*i.length)];setTimeout(function(){e&&(e.textContent=d.substring(0,8)+"..."+d.slice(-4))},500),setTimeout(function(){o&&(o.textContent="12.000000 XRP")},1200),setTimeout(function(){r&&(r.innerHTML='Credits <i class="fas fa-check-circle" style="color:var(--green);margin-left:4px"></i>'),a&&(a.style.display="block")},1800)}function Y(e,o){U=o;var r=(_[o]||_.starter).sls,a=document.getElementById("demoStep3Status");a&&a.innerHTML.indexOf("Credits")!==-1&&(a.innerHTML='<i class="fas fa-check" style="color:#00aaff;margin-right:3px;"></i> '+r.toLocaleString()+" Credits");var i=document.getElementById("demoSlsBalance");i&&(i.textContent=r.toLocaleString()+" Credits"),_demoSession&&_demoSession.subscription&&(_demoSession.subscription.sls_allocation=r,_demoSession.subscription.label=(_[o]||_.starter).label),document.querySelectorAll(".onboard-tier").forEach(function(l){l.classList.remove("selected")}),e.classList.add("selected");var d=_[o],u=document.getElementById("onboardSlsBal"),t=document.getElementById("onboardSlsAnchors");u&&(u.textContent=d.sls.toLocaleString()),t&&(t.textContent=(d.sls*100).toLocaleString());var n=document.getElementById("slsBarBalance");n&&(n.textContent=d.sls.toLocaleString()+" Credits");var s=document.getElementById("toolSlsBal");s&&(s.textContent=d.sls.toLocaleString());var c=document.getElementById("sidebarSlsBal");c&&(c.textContent=d.sls.toLocaleString()+" Credits")}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("platformWorkspace");e&&e.style.display==="block"&&!sessionStorage.getItem("s4_onboard_done")&&setTimeout($,600)});window.showOnboarding=$;window.closeOnboarding=H;window.onboardNext=j;window.selectOnboardTier=Y;(function(){function o(){document.querySelectorAll(".onboard-btn").forEach(function(a){a._s4ob||(a._s4ob=!0,a.addEventListener("click",function(i){i.stopPropagation();var d=(this.textContent||"").toLowerCase();d.indexOf("enter")!==-1?(sessionStorage.setItem("s4_entered","1"),H()):j()}))}),document.querySelectorAll(".onboard-tier").forEach(function(a){a._s4ob||(a._s4ob=!0,a.addEventListener("click",function(i){i.stopPropagation();var d=this.getAttribute("data-tier")||"starter";Y(this,d)}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o):o();var r=setInterval(function(){var a=document.getElementById("onboardOverlay");a&&a.style.display==="flex"&&(o(),clearInterval(r))},200);setTimeout(function(){clearInterval(r)},3e4)})();(function(){if(sessionStorage.getItem("s4_onboard_done"))return;var o=0;function r(){o++;var a=document.getElementById("platformWorkspace");if(a&&a.style.display==="block"&&!sessionStorage.getItem("s4_onboard_done")){$();return}o<300&&setTimeout(r,100)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){setTimeout(r,200)}):setTimeout(r,200)})();var R=null;function ne(){document.querySelectorAll(".tab-pane").forEach(function(n){n.classList.remove("show","active"),n.style.display="none"});var e=document.getElementById("sectionSystems");e&&(e.style.display="none"),document.querySelectorAll(".ils-hub-panel").forEach(function(n){n.classList.remove("active"),n.style.display="none"});var o=document.getElementById("ilsToolBackBar");o&&(o.style.display="none");var r=document.getElementById("ilsSubHub");r&&(r.style.display="grid");var a=document.querySelector(".ils-hub-tabs");a&&(a.style.display="none"),R=null;var i=document.getElementById("platformHub");i&&(i.style.display="block",i.style.animation="fadeIn 0.3s ease");var d=document.getElementById("statsRow");if(d&&(d.style.display="flex"),!sessionStorage.getItem("s4_entered")){var u=document.querySelector(".hero");u&&(u.style.display="block");var t=document.getElementById("platformLanding");t&&(t.style.display="block")}history.replaceState(null,"",window.location.pathname)}function N(e){var o=document.getElementById("platformHub");o&&(o.style.display="none");var r=document.querySelector(".hero");r&&(r.style.display="none");var a=document.getElementById("platformLanding");a&&(a.style.display="none"),document.querySelectorAll(".tab-pane").forEach(function(l){l.classList.remove("show","active"),l.style.display="none"});var i=document.getElementById("sectionSystems");i&&(i.style.display="none");var d={sectionAnchor:"tabAnchor",sectionVerify:"tabVerify",sectionLog:"tabLog",sectionILS:"tabILS",sectionSystems:"sectionSystems",sectionMetrics:"tabMetrics",sectionOffline:"tabOffline"};if(e==="sectionSystems")i&&(i.style.display="block",i.classList.add("show","active"),i.style.animation="fadeIn 0.3s ease");else{var u=d[e]||e,t=document.getElementById(u);t&&(t.style.display="block",t.classList.add("show","active"),t.style.animation="fadeIn 0.3s ease");var n=document.querySelector('a[href="#'+u+'"]');if(n)try{new bootstrap.Tab(n).show()}catch{}}if(e==="sectionILS"){var s=document.getElementById("ilsSubHub");s&&(s.style.display="grid");var c=document.getElementById("ilsToolBackBar");c&&(c.style.display="none"),document.querySelectorAll(".ils-hub-panel").forEach(function(l){l.classList.remove("active")})}}function se(e){var o=document.getElementById("sectionSystems");o&&(o.style.display="none");var r=document.getElementById(e);r&&(r.style.display="block",r.classList.add("show","active"),r.style.animation="fadeIn 0.3s ease")}function V(e){var o=document.getElementById("ilsSubHub");o&&(o.style.display="none");var r=document.getElementById("ilsToolBackBar");r&&(r.style.display="block"),document.querySelectorAll(".ils-hub-panel").forEach(function(d){d.classList.remove("active"),d.style.display="none"});var a=document.getElementById(e);a&&(a.style.display="block",a.classList.add("active"),a.style.animation="fadeIn 0.3s ease");var i=document.querySelector('.ils-hub-tab[onclick*="'+e+'"]');i&&(document.querySelectorAll(".ils-hub-tab").forEach(function(d){d.classList.remove("active")}),i.classList.add("active")),e==="hub-actions"&&(typeof renderHubActions=="function"&&renderHubActions(),typeof renderActionCalendar=="function"&&(setTimeout(renderActionCalendar,200),setTimeout(renderActionCalendar,600))),e==="hub-vault"&&typeof renderVault=="function"&&renderVault(),e==="hub-docs"&&typeof renderDocLibrary=="function"&&renderDocLibrary(),e==="hub-compliance"&&typeof calcCompliance=="function"&&calcCompliance(),e==="hub-risk"&&typeof loadRiskData=="function"&&loadRiskData(),e==="hub-roi"&&typeof calcROI=="function"&&calcROI(),e==="hub-reports"&&typeof loadReportPreview=="function"&&loadReportPreview(),e==="hub-predictive"&&typeof loadPredictiveData=="function"&&loadPredictiveData(),e==="hub-submissions"&&typeof loadSubmissionHistory=="function"&&loadSubmissionHistory(),e==="hub-sbom"&&typeof loadSBOMData=="function"&&loadSBOMData(),e==="hub-dmsms"&&typeof loadDMSMSData=="function"&&loadDMSMSData(),e==="hub-readiness"&&typeof loadReadinessData=="function"&&loadReadinessData(),e==="hub-lifecycle"&&typeof calcLifecycle=="function"&&calcLifecycle(),e==="hub-analysis"&&typeof initILSChecklist=="function"&&initILSChecklist(),typeof updateAiContext=="function"&&updateAiContext(e),(function(){var d=document.getElementById(e);if(!d)return;var u=d.querySelector("details");if(!u)return;u.style.display="none";var t="s4_hiw_"+e;function n(){var l=document.querySelector(".hiw-modal-overlay");l&&l.remove();var m=u.querySelector("summary")?u.querySelector("summary").textContent.replace(/[▸▾▾]/g,"").trim():"How It Works",f="";u.querySelectorAll("p,ol,ul,li").forEach(function(p){f+=p.outerHTML}),f||(f=u.innerHTML.replace(/<summary[^>]*>.*?<\/summary>/i,""));var b=document.createElement("div");b.className="hiw-modal-overlay",b.innerHTML='<div class="hiw-modal-box"><button class="hiw-close" title="Close">&times;</button><h4><i class="fas fa-info-circle" style="margin-right:6px"></i>'+m+'</h4><div class="hiw-body">'+f+"</div></div>",b.querySelector(".hiw-close").onclick=function(){b.remove()},b.onclick=function(p){p.target===b&&b.remove()},document.body.appendChild(b)}localStorage.getItem(t)||(localStorage.setItem(t,"1"),setTimeout(n,300));var s=d.querySelector("h3")||d.querySelector("h4")||d.querySelector(".hub-tool-header h4")||d.querySelector("h5");if(s&&!s.querySelector(".hiw-help-btn")){var c=document.createElement("button");c.className="hiw-help-btn",c.title="How It Works",c.textContent="?",c.style.cssText="margin-left:8px;background:rgba(0,170,255,0.12);border:1px solid rgba(0,170,255,0.3);color:#00aaff;border-radius:50%;width:22px;height:22px;font-size:0.72rem;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;",c.onclick=function(l){l.stopPropagation(),n()},s.appendChild(c)}})(),R=e}function le(){document.querySelectorAll(".ils-hub-panel").forEach(function(i){i.classList.remove("active"),i.style.display="none"});var e=document.getElementById("ilsSubHub");e&&(e.style.display="grid",e.style.animation="fadeIn 0.3s ease");var o=document.getElementById("ilsToolBackBar");o&&(o.style.display="none");var r=document.querySelector(".ils-hub-tabs");if(r&&(r.style.display="none"),R=null,_currentRole&&typeof applyTabVisibility=="function"){var a=_customVisibleTabs||(_s4Roles[_currentRole]?_s4Roles[_currentRole].tabs:_allHubTabs);applyTabVisibility(a)}}(function(){var o="s4_demo_tool_card_order";function r(){return document.getElementById("ilsSubHub")}function a(){var u=r();if(u){var t=localStorage.getItem(o);if(t)try{var n=JSON.parse(t),s=Array.from(u.querySelectorAll(".ils-tool-card")),c={};s.forEach(function(l){var m=l.getAttribute("onclick")||"",f=(m.match(/openILSTool\('([^']+)'\)/)||[])[1];f&&(c[f]=l)}),n.forEach(function(l){c[l]&&u.appendChild(c[l])})}catch{}}}function i(){var u=r();if(u){var t=u.querySelectorAll(".ils-tool-card"),n=[];t.forEach(function(s){var c=s.getAttribute("onclick")||"",l=(c.match(/openILSTool\('([^']+)'\)/)||[])[1];l&&n.push(l)}),localStorage.setItem(o,JSON.stringify(n))}}function d(){var u=r();if(u){var t=null;u.querySelectorAll(".ils-tool-card").forEach(function(n){n.setAttribute("draggable","true"),n.addEventListener("dragstart",function(f){t=this,this.classList.add("dragging"),f.dataTransfer.effectAllowed="move",f.dataTransfer.setData("text/plain","")}),n.addEventListener("dragend",function(){this.classList.remove("dragging"),u.querySelectorAll(".ils-tool-card").forEach(function(f){f.classList.remove("drag-over")})}),n.addEventListener("dragover",function(f){f.preventDefault(),f.dataTransfer.dropEffect="move",this!==t&&this.classList.add("drag-over")}),n.addEventListener("dragleave",function(){this.classList.remove("drag-over")}),n.addEventListener("drop",function(f){if(f.preventDefault(),this.classList.remove("drag-over"),t&&t!==this){var b=Array.from(u.querySelectorAll(".ils-tool-card")),p=b.indexOf(t),v=b.indexOf(this);p<v?u.insertBefore(t,this.nextSibling):u.insertBefore(t,this),i(),d()}t=null});var s=null,c=!1,l=null,m=null;n.addEventListener("touchstart",function(f){var b=this;s=setTimeout(function(){c=!0,m=b,b.classList.add("dragging"),l=b.cloneNode(!0),l.style.position="fixed",l.style.pointerEvents="none",l.style.opacity="0.85",l.style.zIndex="9999",l.style.width=b.offsetWidth+"px",l.style.transform="scale(1.05)",l.style.boxShadow="0 8px 32px rgba(0,170,255,0.3)",document.body.appendChild(l)},500)},{passive:!0}),n.addEventListener("touchmove",function(f){if(!(!c||!l)){f.preventDefault();var b=f.touches[0];l.style.left=b.clientX-l.offsetWidth/2+"px",l.style.top=b.clientY-l.offsetHeight/2+"px",u.querySelectorAll(".ils-tool-card").forEach(function(g){g.classList.remove("drag-over")});var p=document.elementFromPoint(b.clientX,b.clientY);if(p){var v=p.closest(".ils-tool-card");v&&v!==m&&v.classList.add("drag-over")}}},{passive:!1}),n.addEventListener("touchend",function(f){if(clearTimeout(s),c&&m){var b=f.changedTouches[0],p=document.elementFromPoint(b.clientX,b.clientY),v=p?p.closest(".ils-tool-card"):null;if(v&&v!==m){var g=Array.from(u.querySelectorAll(".ils-tool-card")),L=g.indexOf(m),S=g.indexOf(v);L<S?u.insertBefore(m,v.nextSibling):u.insertBefore(m,v),i(),d()}m.classList.remove("dragging"),u.querySelectorAll(".ils-tool-card").forEach(function(x){x.classList.remove("drag-over")})}l&&l.parentNode&&l.parentNode.removeChild(l),c=!1,l=null,m=null}),n.addEventListener("touchcancel",function(){clearTimeout(s),l&&l.parentNode&&l.parentNode.removeChild(l),m&&m.classList.remove("dragging"),u.querySelectorAll(".ils-tool-card").forEach(function(f){f.classList.remove("drag-over")}),c=!1,l=null,m=null})})}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){a(),d()}):(a(),d())})();function ce(){var e=document.getElementById("walletSidebar"),o=document.getElementById("walletOverlay");e&&e.classList.add("open"),o&&o.classList.add("show");var r=document.getElementById("walletSidebarBody"),a=document.getElementById("tabWallet");r&&a&&!r.dataset.loaded&&(r.innerHTML=a.innerHTML,r.dataset.loaded="true",typeof loadWalletData=="function"&&loadWalletData(),de(r)),ee()}function de(e){var o=e.querySelector("#slsToggleBtn");if(o){o.removeAttribute("onclick");var r=document.createElement("div");r.id="sidebarFlowPanel",r.style.cssText="display:none;margin-top:12px;background:linear-gradient(135deg,rgba(0,170,255,0.06),rgba(201,168,76,0.04));border:1px solid rgba(0,170,255,0.25);border-radius:3px;padding:16px 18px;",r.innerHTML='<div style="position:relative"><div style="position:absolute;top:-4px;right:0;background:linear-gradient(135deg,#00aaff,#c9a84c);padding:3px 12px;border-radius:0 10px 0 8px;font-size:0.62rem;font-weight:700;color:#050810;letter-spacing:0.5px">LIVE PREVIEW</div><h4 style="margin:0 0 4px;font-size:0.95rem;color:#fff"><i class="fas fa-flask" style="color:#00aaff;margin-right:6px"></i>Credit Economic Flow</h4><p style="color:#8ea4b8;font-size:0.72rem;margin:0 0 12px">See how the Credits token economy works. <strong style="color:#c9a84c">Every anchor costs 0.01 Credits.</strong></p><div style="display:grid;grid-template-columns:1fr 1fr;gap:8px"><div style="background:rgba(0,170,255,0.08);border:1px solid rgba(0,170,255,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(0,170,255,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-user-plus" style="color:#00aaff;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">1. Account</div><div style="font-size:0.62rem;color:#8ea4b8">Created &amp; provisioned</div></div><div style="background:rgba(0,170,255,0.08);border:1px solid rgba(0,170,255,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(0,170,255,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-wallet" style="color:#00aaff;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">2. Wallet Funded</div><div style="font-size:0.62rem;color:#8ea4b8">12 XRP reserve</div></div><div style="background:rgba(201,168,76,0.08);border:1px solid rgba(201,168,76,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(201,168,76,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-coins" style="color:#c9a84c;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">3. Credits Allocated</div><div style="font-size:0.62rem;color:#8ea4b8">Based on plan tier</div></div><div style="background:rgba(0,170,255,0.08);border:1px solid rgba(0,170,255,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(0,170,255,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-arrow-right" style="color:#00aaff;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">4. 0.01 Credits &rarr; Treasury</div><div style="font-size:0.62rem;color:#8ea4b8">Per anchor fee</div></div></div><div style="margin-top:10px;padding:8px 12px;background:rgba(0,0,0,0.25);border-radius:3px;font-size:0.7rem"><div style="display:flex;justify-content:space-between;flex-wrap:wrap;gap:6px"><div><span style="color:#8ea4b8">Wallet:</span> <span style="color:#00aaff;font-family:monospace" id="sidebarWalletAddr">rMLmk...f1KLqJ</span></div><div><span style="color:#8ea4b8">Balance:</span> <span style="color:#c9a84c;font-weight:700" id="sidebarSlsBal">'+(document.getElementById("slsBarBalance")?document.getElementById("slsBarBalance").textContent:"25,000")+" Credits</span></div></div></div></div>";var a=e.querySelector("#slsBalanceBar");a?a.parentNode.insertBefore(r,a.nextSibling):e.insertBefore(r,e.firstChild?e.firstChild.nextSibling:null);var i=!1;o.addEventListener("click",function(){i=!i,r.style.display=i?"block":"none",o.innerHTML=i?'<i class="fas fa-chevron-up" style="margin-right:4px"></i>Hide Flow Details':'<i class="fas fa-chart-simple" style="margin-right:4px"></i>Show Flow Details'})}}function ue(){var e=document.getElementById("walletSidebar"),o=document.getElementById("walletOverlay");e&&e.classList.remove("open"),o&&o.classList.remove("show")}function ee(){var e=document.getElementById("slsBarBalance"),o=document.getElementById("walletTriggerBal");e&&o&&(o.textContent=e.textContent||"--")}document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){var e=document.getElementById("platformHub");e&&(e.style.display="block"),document.querySelectorAll(".tab-pane").forEach(function(r){r.classList.remove("show","active"),r.style.display="none"});var o=document.getElementById("demoPanel");o&&(o.style.display="none")},100)});document.addEventListener("shown.bs.tab",function(e){ee()});(function(){function e(){var r=document.getElementById("actionItemBadge");if(r){var a=0;typeof s4ActionItems<"u"&&Array.isArray(s4ActionItems)&&(a=s4ActionItems.filter(function(i){return!i.done}).length),a>0?(r.textContent=a,r.style.display="inline-flex"):r.style.display="none"}}setInterval(e,3e3),document.addEventListener("DOMContentLoaded",function(){setTimeout(e,2e3)});var o=N;N=function(r){o(r),setTimeout(e,500)}})();(function(){function e(){var r=document.getElementById("slsBarBalance"),a=document.getElementById("slsBarAnchors"),i=document.getElementById("slsBarSpent"),d=document.getElementById("toolSlsBal"),u=document.getElementById("toolSlsAnch"),t=document.getElementById("toolSlsSpent");d&&r&&(d.textContent=r.textContent.replace(" Credits","")),u&&a&&(u.textContent=a.textContent),t&&i&&(t.textContent=i.textContent.replace(" Credits",""))}setInterval(e,2e3);var o=V;V=function(r){o(r),setTimeout(e,200)}})();(function(){var e=hideAnchorAnimation;hideAnchorAnimation=function(){if(e(),R){var o=document.getElementById(R);if(!o)return;var r=o.querySelector(".anchor-confirm-banner");r&&r.remove();var a=s4Vault.length>0?s4Vault[0]:null;if(!a)return;var i=document.createElement("div");i.className="anchor-confirm-banner",i.style.cssText="background:linear-gradient(135deg,rgba(0,204,102,0.08),rgba(0,170,255,0.06));border:1px solid rgba(0,204,102,0.2);border-radius:3px;padding:16px 20px;margin-bottom:16px;animation:panelSlideIn 0.4s ease;position:relative",i.innerHTML='<button onclick="this.parentElement.remove()" style="position:absolute;top:8px;right:12px;background:none;border:none;color:var(--muted);cursor:pointer;font-size:0.85rem">&times;</button><div style="display:flex;align-items:center;gap:8px;margin-bottom:8px"><i class="fas fa-check-circle" style="color:#00cc66;font-size:1.1rem"></i><strong style="color:#fff;font-size:0.9rem">Record Anchored Successfully</strong></div><div style="font-size:0.78rem;color:var(--steel);display:grid;grid-template-columns:80px 1fr;gap:4px 12px"><span style="color:var(--muted)">Type:</span><span>'+(a.label||a.type)+'</span><span style="color:var(--muted)">Hash:</span><span style="font-family:monospace;color:var(--accent);font-size:0.72rem;word-break:break-all">'+(a.hash||"").substring(0,32)+'...</span><span style="color:var(--muted)">TX:</span><span>'+(a.txHash?'<a href="'+(a.explorerUrl||"#")+'" target="_blank" style="color:var(--accent);text-decoration:none">'+a.txHash.substring(0,16)+'... <i class="fas fa-external-link-alt" style="font-size:0.6rem"></i></a>':"Pending")+'</span><span style="color:var(--muted)">Fee:</span><span style="color:#c9a84c">0.01 Credits</span><span style="color:var(--muted)">Time:</span><span>'+new Date().toLocaleTimeString()+"</span></div>";var d=o.querySelector(".demo-card");d&&d.insertBefore(i,d.firstChild),setTimeout(function(){i.parentElement&&i.remove()},15e3)}}})();var W=["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team","tabAnchor","tabVerify"];function fe(e){var o=document.querySelector(".hiw-modal-overlay");o&&o.remove();var r=e.querySelector("summary")?e.querySelector("summary").textContent.replace(/[\u25B8\u25BE\u25BE]/g,"").trim():"How It Works",a="";e.querySelectorAll("p,ol,ul,li").forEach(function(d){a+=d.outerHTML}),a||(a=e.innerHTML.replace(/<summary[^>]*>.*?<\/summary>/i,""));var i=document.createElement("div");i.className="hiw-modal-overlay",i.innerHTML='<div class="hiw-modal-box"><button class="hiw-close" title="Close">&times;</button><h4><i class="fas fa-info-circle" style="margin-right:6px"></i>'+r+'</h4><div class="hiw-body">'+a+"</div></div>",i.querySelector(".hiw-close").onclick=function(){i.remove()},i.onclick=function(d){d.target===i&&i.remove()},document.body.appendChild(i)}function Z(e){var o=document.getElementById(e);if(o){var r=o.querySelector("details");if(r){r.style.display="none";var a=o.querySelector("h3")||o.querySelector("h4")||o.querySelector(".hub-tool-header h4")||o.querySelector("h5");if(a&&!a.querySelector(".hiw-help-btn")){var i=document.createElement("button");i.className="hiw-help-btn",i.title="How It Works",i.textContent="?",i.style.cssText="margin-left:8px;background:rgba(0,170,255,0.12);border:1px solid rgba(0,170,255,0.3);color:#00aaff;border-radius:50%;width:24px;height:24px;font-size:0.75rem;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;flex-shrink:0;",i.onclick=function(d){d.stopPropagation(),fe(r)},a.appendChild(i)}}}}(function(){function o(){W.forEach(function(a){Z(a)})}if(o(),setTimeout(o,500),setTimeout(o,2e3),typeof MutationObserver<"u"){var r=new MutationObserver(function(a){var i=!1;a.forEach(function(d){d.type==="childList"&&d.removedNodes.length>0&&d.removedNodes.forEach(function(u){u.classList&&u.classList.contains("hiw-help-btn")&&(i=!0),u.querySelector&&u.querySelector(".hiw-help-btn")&&(i=!0)})}),i&&setTimeout(function(){W.forEach(Z)},50)});W.forEach(function(a){var i=document.getElementById(a);i&&r.observe(i,{childList:!0,subtree:!0})})}})();document.addEventListener("DOMContentLoaded",function(){["tabAnchor","tabVerify"].forEach(function(e){var o=document.getElementById(e);if(!o)return;var r=o.querySelector("details");if(!r)return;r.style.display="none";var a="s4_hiw_"+e;function i(){var t=document.querySelector(".hiw-modal-overlay");t&&t.remove();var n=r.querySelector("summary")?r.querySelector("summary").textContent.replace(/[▸▾]/g,"").trim():"How It Works",s="";r.querySelectorAll("p,ol,ul,li").forEach(function(l){s+=l.outerHTML}),s||(s=r.innerHTML.replace(/<summary[^>]*>.*?<\/summary>/i,""));var c=document.createElement("div");c.className="hiw-modal-overlay",c.innerHTML='<div class="hiw-modal-box"><button class="hiw-close" title="Close">&times;</button><h4><i class="fas fa-info-circle" style="margin-right:6px"></i>'+n+'</h4><div class="hiw-body">'+s+"</div></div>",c.querySelector(".hiw-close").onclick=function(){c.remove()},c.onclick=function(l){l.target===c&&c.remove()},document.body.appendChild(c)}var d=o.querySelector("h3");if(d&&!d.querySelector(".hiw-help-btn")){var u=document.createElement("button");u.className="hiw-help-btn",u.title="How It Works",u.textContent="?",u.style.cssText="margin-left:8px;background:rgba(0,170,255,0.12);border:1px solid rgba(0,170,255,0.3);color:#00aaff;border-radius:50%;width:22px;height:22px;font-size:0.72rem;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;",u.onclick=function(t){t.stopPropagation(),i()},d.appendChild(u)}document.addEventListener("shown.bs.tab",function(t){var n=t.target.getAttribute("href")||t.target.getAttribute("data-bs-target");n==="#"+e&&!localStorage.getItem(a)&&(localStorage.setItem(a,"1"),setTimeout(i,300))})})});window.closeILSTool=le;window.closeWalletSidebar=ue;window.openILSTool=V;window.openWalletSidebar=ce;window.showHub=ne;window.showSection=N;window.showSystemsSub=se;var y={ils_manager:{label:"ILS Manager",icon:"fa-clipboard-list",desc:"Full ILS tool suite access",tabs:["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team"]},dmsms_analyst:{label:"DMSMS Analyst",icon:"fa-microchip",desc:"DMSMS tracking and obsolescence management",tabs:["hub-dmsms","hub-risk","hub-lifecycle","hub-actions","hub-vault","hub-docs","hub-reports"]},auditor:{label:"Auditor / Compliance",icon:"fa-shield-halved",desc:"Compliance scorecard and audit vault",tabs:["hub-compliance","hub-vault","hub-actions","hub-docs","hub-reports","hub-submissions"]},contracts:{label:"Contract Specialist",icon:"fa-file-contract",desc:"ROI, submissions, and document management",tabs:["hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-actions","hub-cdrl","hub-contract"]},supply_chain:{label:"Supply Chain / Provisioning",icon:"fa-truck",desc:"Supply, readiness, and provisioning tools",tabs:["hub-readiness","hub-risk","hub-lifecycle","hub-actions","hub-vault","hub-docs","hub-submissions"]},admin:{label:"Full Access Admin",icon:"fa-user-shield",desc:"All tools visible — unrestricted access",tabs:["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team"]}},X=["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team"],me={"hub-analysis":"Gap Analysis","hub-dmsms":"DMSMS Tracker","hub-readiness":"Readiness Calc","hub-compliance":"Compliance","hub-risk":"Supply Chain Risk","hub-actions":"Action Items","hub-predictive":"Predictive Maint","hub-lifecycle":"Lifecycle Cost","hub-roi":"ROI Calculator","hub-vault":"Audit Vault","hub-docs":"Document Library","hub-reports":"Report Gen","hub-submissions":"Submissions & PTD","hub-sbom":"SBOM Viewer","hub-gfp":"GFP Tracker","hub-cdrl":"CDRL Validator","hub-contract":"Contract Extractor","hub-provenance":"Provenance Chain","hub-analytics":"Cross-Program Analytics","hub-team":"Team Management"},h=sessionStorage.getItem("s4_user_role")||"",z=sessionStorage.getItem("s4_user_title")||"",w=JSON.parse(sessionStorage.getItem("s4_visible_tabs")||"null");function te(){var e=document.createElement("div");e.id="roleModal",e.style.cssText="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);z-index:10000;display:flex;align-items:center;justify-content:center;animation:fadeIn 0.3s ease";var o='<div style="background:var(--card);border:1px solid var(--border);border-radius:3px;padding:32px;max-width:620px;width:95%;max-height:85vh;overflow-y:auto"><h3 style="color:#fff;margin:0 0 4px"><i class="fas fa-user-cog" style="color:var(--accent);margin-right:8px"></i>Configure Your Role</h3><p style="color:var(--steel);font-size:0.85rem;margin-bottom:20px">Select your role to see relevant tools. You can customize visible tools and your displayed title.</p><div style="margin-bottom:16px"><label style="color:var(--steel);font-size:0.8rem;font-weight:600">Your Display Title</label><input id="roleTitle" value="'+(z||"")+'" style="background:#0a0e1a;color:#fff;border:1px solid rgba(255,255,255,0.15);border-radius:3px;padding:10px;width:100%;margin-top:4px" placeholder="e.g., ILS Analyst, Logistics Specialist, Contract Manager"></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px">';Object.keys(y).forEach(function(r){var a=y[r],i=h===r?"border-color:var(--accent);background:rgba(0,170,255,0.08)":"";o+=`<div class="role-card" onclick="selectRolePreset('`+r+`')" style="border:2px solid `+(i?"var(--accent)":"var(--border)")+";border-radius:3px;padding:14px;cursor:pointer;transition:all 0.2s;"+(i?"background:rgba(0,170,255,0.08)":"")+'" data-role="'+r+'"><div style="display:flex;align-items:center;gap:8px;margin-bottom:6px"><i class="fas '+a.icon+'" style="color:var(--accent);font-size:1.1rem"></i><strong style="color:#fff;font-size:0.9rem">'+a.label+'</strong></div><div style="color:var(--steel);font-size:0.78rem">'+a.desc+'</div><div style="color:var(--muted);font-size:0.72rem;margin-top:4px">'+a.tabs.length+" tools</div></div>"}),o+='</div><details style="margin-bottom:20px;background:rgba(0,170,255,0.03);border:1px solid rgba(0,170,255,0.12);border-radius:3px;padding:0 16px"><summary style="cursor:pointer;color:var(--accent);font-weight:600;font-size:0.85rem;padding:12px 0;list-style:none;display:flex;align-items:center;gap:8px"><i class="fas fa-sliders-h"></i> Customize Visible Tools <i class="fas fa-chevron-down" style="font-size:0.7rem;margin-left:auto;opacity:0.5"></i></summary><div id="roleToolChecks" style="display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:0 0 16px">',X.forEach(function(r){var a=w?w.indexOf(r)>=0:h?(y[h]?.tabs||[]).indexOf(r)>=0:!0;o+='<label style="display:flex;align-items:center;gap:8px;font-size:0.82rem;color:var(--steel);cursor:pointer;padding:6px 10px;border-radius:3px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.06);transition:all 0.2s"><input type="checkbox" data-tab="'+r+'" '+(a?"checked":"")+' onchange="onRoleToolToggle()" style="accent-color:#00aaff;width:16px;height:16px;flex-shrink:0"> <span>'+(me[r]||r)+"</span></label>"}),o+=`</div></details><div style="display:flex;gap:10px;justify-content:flex-end"><button onclick="document.getElementById('roleModal').remove()" style="background:rgba(255,255,255,0.06);color:var(--steel);border:1px solid var(--border);border-radius:3px;padding:8px 20px;cursor:pointer">Cancel</button><button onclick="applyRole()" style="background:var(--accent);color:#fff;border:none;border-radius:3px;padding:8px 24px;cursor:pointer;font-weight:600">Apply Role</button></div></div>`,e.innerHTML=o,document.body.appendChild(e)}function be(e){h=e,document.querySelectorAll(".role-card").forEach(function(i){i.style.borderColor="var(--border)",i.style.background=""});var o=document.querySelector('.role-card[data-role="'+e+'"]');o&&(o.style.borderColor="var(--accent)",o.style.background="rgba(0,170,255,0.08)");var r=y[e].tabs;document.querySelectorAll('#roleToolChecks input[type="checkbox"]').forEach(function(i){i.checked=r.indexOf(i.dataset.tab)>=0});var a=document.getElementById("roleTitle");a&&!a.value&&(a.value=y[e].label)}function pe(){w=[],document.querySelectorAll('#roleToolChecks input[type="checkbox"]').forEach(function(e){e.checked&&w.push(e.dataset.tab)})}function ve(){var e=document.getElementById("roleTitle")?.value?.trim()||"";z=e,sessionStorage.setItem("s4_user_role",h),sessionStorage.setItem("s4_user_title",z);var o;w?(o=w,sessionStorage.setItem("s4_visible_tabs",JSON.stringify(w))):h&&y[h]?(o=y[h].tabs,sessionStorage.removeItem("s4_visible_tabs")):o=X,oe(o),re(),typeof reloadVaultForRole=="function"&&reloadVaultForRole(),document.getElementById("roleModal")?.remove(),s4Notify("Role Applied",(e||y[h]?.label||"Custom")+" — "+o.length+" tools active","success")}function oe(e){document.querySelectorAll(".ils-hub-tab").forEach(function(o){var r=o.getAttribute("onclick")||"",a=r.match(/switchHubTab\('([^']+)'/);if(a){var i=a[1];o.style.display=e.indexOf(i)>=0?"":"none"}}),document.querySelectorAll(".ils-tool-card[onclick]").forEach(function(o){var r=o.getAttribute("onclick")||"",a=r.match(/openILSTool\('([^']+)'/);a&&(o.style.display=e.indexOf(a[1])>=0?"":"none")})}function re(){var e=document.getElementById("roleBadge");if(!e){var o=document.querySelector(".ils-hub-tabs")?.previousElementSibling;if(!o)return;var r=o.querySelector("div:last-child");if(!r)return;e=document.createElement("span"),e.id="roleBadge",e.style.cssText="display:inline-flex;align-items:center;gap:6px;padding:5px 12px;border-radius:3px;font-size:0.75rem;font-weight:600;background:rgba(0,170,255,0.1);border:1px solid rgba(0,170,255,0.25);color:#00aaff;cursor:pointer;transition:all 0.2s;hover:background:rgba(0,170,255,0.2)",e.title="Click to change your role",e.onclick=te,r.appendChild(e)}var a=h?y[h]?.icon||"fa-user":"fa-user-cog",i=z||(h?y[h]?.label:"Set Role");e.innerHTML='<i class="fas '+a+'"></i> '+i+' <i class="fas fa-gear" style="font-size:0.6rem;opacity:0.6"></i>'}function Q(){if(h){var e=w||(y[h]?y[h].tabs:X);oe(e),typeof reloadVaultForRole=="function"&&reloadVaultForRole()}re(),h||setTimeout(function(){var o=document.getElementById("platformWorkspace");o&&o.style.display==="block"&&sessionStorage.getItem("s4_onboard_done")&&te()},2500)}(function(){function e(t){return Math.round(t).toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",")}function o(){try{var t=function(M){var P=document.getElementById(M);return P&&parseFloat(P.value)||0},n=t("roiPrograms"),s=t("roiRecords"),c=t("roiFTEs"),l=t("roiRate"),m=t("roiAudit"),f=t("roiError"),b=t("roiIncidents"),p=t("roiLicense"),v=n*s,g=1+Math.sqrt(Math.max(0,v))/50,L=c*2080,S=L*l,x=S*.65*g,k=b*f*.9,q=m*.7*Math.max(1,n/5),D=v>0?x/12/v:0,B=x+k+q,I=B-p,C=p>0?I/p*100:0,T=B>0?Math.ceil(p/B*12):0,A=B*5-p*5,O=function(M,P,J){var F=document.getElementById(M);F&&(F.textContent=P,J&&(F.style.color=J))};O("roiSavings","$"+e(I),I>0?"#00cc66":"#ff4444"),O("roiPercent",C.toFixed(0)+"%",C>0?"#00cc66":"#ff4444"),O("roiPayback",T+" mo",null),O("roi5Year","$"+e(A),A>0?"#00cc66":"#ff4444");var G=document.getElementById("roiOutput");G&&(G.innerHTML='<div style="background:var(--surface);border:1px solid var(--border);border-radius:3px;padding:20px;margin-top:12px"><div class="section-label"><i class="fas fa-chart-line"></i> ROI BREAKDOWN</div><div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;font-size:0.85rem;margin-bottom:16px"><div><span style="color:var(--steel)">Labor Automation (65%)</span><br><strong style="color:#00cc66">$'+e(x)+'</strong></div><div><span style="color:var(--steel)">Error Reduction (90%)</span><br><strong style="color:#00cc66">$'+e(k)+'</strong></div><div><span style="color:var(--steel)">Audit Cost Reduction (70%)</span><br><strong style="color:#00cc66">$'+e(q)+'</strong></div><div><span style="color:var(--steel)">S4 Ledger License</span><br><strong style="color:#ff6b6b">-$'+e(p)+'</strong></div></div><hr style="border-color:var(--border);margin:12px 0"><div style="display:flex;justify-content:space-between;align-items:center"><div><span style="color:var(--steel);font-size:0.82rem">Net Annual Savings</span><br><span style="font-size:1.5rem;font-weight:800;color:'+(I>0?"#00cc66":"#ff4444")+'">$'+e(I)+'</span></div><div><span style="color:var(--steel);font-size:0.82rem">Per-Record Savings</span><br><span style="font-size:1.1rem;font-weight:700;color:var(--accent)">$'+D.toFixed(2)+'/record</span></div><div><span style="color:var(--steel);font-size:0.82rem">Volume Multiplier</span><br><span style="font-size:1.1rem;font-weight:700;color:var(--accent)">'+g.toFixed(2)+"x</span></div></div></div>");try{typeof renderROICharts=="function"&&renderROICharts()}catch{}}catch{}}function r(){var t=["roiPrograms","roiRecords","roiFTEs","roiRate","roiAudit","roiError","roiIncidents","roiLicense"],n=0;return t.forEach(function(s){var c=document.getElementById(s);c&&(c.removeAttribute("oninput"),c.addEventListener("input",o),n++)}),n>0&&o(),n}function a(){var t={};try{var n=document.querySelectorAll('#ilsCoverage input[type="checkbox"], .ils-checklist input[type="checkbox"]'),s=0,c=n.length||1;n.forEach(function(f){f.checked&&s++}),t.ilsPct=Math.round(s/c*100)}catch{t.ilsPct=0}var l=["pctCMMC","pctNIST","pctDFARS","pctFAR","pctILS","pctDMSMSmgmt"];t.comp=l.map(function(f){var b=document.getElementById(f);return b&&parseInt(b.textContent)||0}),t.vault=typeof s4Vault<"u"?s4Vault.length:typeof getLocalRecords=="function"?getLocalRecords().length:0,t.actions=typeof s4ActionItems<"u"?s4ActionItems.length:0,t.actionsDone=0,typeof s4ActionItems<"u"&&s4ActionItems.forEach(function(f){f.status==="done"&&t.actionsDone++});var m=function(f){var b=document.getElementById(f);return b&&parseFloat(b.value)||0};return t.roiPrograms=m("roiPrograms"),t.roiRecords=m("roiRecords"),t.roiFTEs=m("roiFTEs"),t.roiRate=m("roiRate"),t.roiLicense=m("roiLicense"),t.roiAudit=m("roiAudit"),t.stats=typeof stats<"u"?stats:{anchored:0,slsFees:0},t.dmsmsItems=typeof dmsmsItems<"u"?dmsmsItems:[],t.riskItems=typeof riskItems<"u"?riskItems:[],t}var i={gapRadarChart:function(){var t=a(),n=Math.min(100,20+t.vault*3),s=Math.min(100,15+t.vault*4),c=Math.min(100,t.comp[0]||10),l=Math.min(100,10+(t.dmsmsItems.length||0)*8),m=Math.min(100,15+(t.riskItems.length||0)*5),f=Math.min(100,20+t.ilsPct*.6),b=[n,s,c,l,m,f].map(function(p){return Math.min(100,p+30+Math.random()*5|0)});return{type:"radar",data:{labels:["Tracking","Audit","Compliance","Obsolescence","Risk","Budget"],datasets:[{label:"Current (Manual)",data:[n,s,c,l,m,f],borderColor:"#ff6b6b",backgroundColor:"rgba(255,107,107,0.1)",pointBackgroundColor:"#ff6b6b"},{label:"With S4 Ledger",data:b,borderColor:"#00aaff",backgroundColor:"rgba(0,170,255,0.1)",pointBackgroundColor:"#00aaff"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#8ea4b8",font:{size:10}}}},scales:{r:{grid:{color:"rgba(255,255,255,0.06)"},angleLines:{color:"rgba(255,255,255,0.06)"},pointLabels:{color:"#8ea4b8",font:{size:9}},ticks:{display:!1}}}}}},gapBarChart:function(){var t=a(),n=Math.max(0,100-(20+t.vault*3)),s=Math.max(0,100-(15+t.vault*4)),c=Math.max(0,100-(t.comp[0]||10)),l=Math.max(0,100-(10+(t.dmsmsItems.length||0)*8)),m=Math.max(0,100-(15+(t.riskItems.length||0)*5)),f=Math.max(0,100-(20+t.ilsPct*.6));return{type:"bar",data:{labels:["Tracking","Audit","Compliance","Obsolescence","Risk","Budget"],datasets:[{label:"Gap %",data:[n,s,c,l,m,f],backgroundColor:["#ff6b6b","#fb923c","#c9a84c","#00aaff","#38bdf8","#06b6d4"],borderWidth:0,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},max:100},y:{ticks:{color:"#8ea4b8",font:{size:9}},grid:{display:!1}}}}}},dmsmsPieChart:function(){var t=a(),n=t.dmsmsItems,s=0,c=0,l=0,m=0,f=0;return n.length>0?n.forEach(function(b){var p=(b.status||"").toLowerCase();p.indexOf("obsolete")>=0?l++:p.indexOf("risk")>=0||p.indexOf("diminish")>=0?c++:p.indexOf("discontin")>=0?m++:p.indexOf("eol")>=0||p.indexOf("last")>=0?f++:s++}):(s=45,c=20,l=15,m=10,f=10),{type:"doughnut",data:{labels:["Active","At Risk","Obsolete","Discontinued","EOL Planned"],datasets:[{data:[s,c,l,m,f],backgroundColor:["#00aaff","#c9a84c","#ff6b6b","#00aaff","#6b7d93"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#8ea4b8",font:{size:9},padding:6}}}}}},readinessGauge:function(){var t=a(),n=Math.max(30,t.ilsPct),s=Math.min(100,n+15+(t.vault>5?10:0)),c=Math.min(100,n+(t.dmsmsItems.length>0?-5:8)),l=Math.min(100,n-12+t.vault*2),m=Math.min(100,n+20),f=Math.min(100,n+6+t.actionsDone*3),b=Math.min(100,n+12);return{type:"bar",data:{labels:["Personnel","Equipment","Supply","Training","Maintenance","C4ISR"],datasets:[{label:"Readiness %",data:[s,c,l,m,f,b],backgroundColor:"rgba(0,170,255,0.6)",borderColor:"#00aaff",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{ticks:{color:"#8ea4b8",font:{size:9}},grid:{display:!1}},y:{ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},beginAtZero:!0,max:100}}}}},complianceRadarChart:function(){var t=a(),n=t.comp[2]||30,s=Math.min(100,40+t.vault*4),c=t.comp[1]||25,l=t.comp[0]||20,m=Math.min(100,30+t.ilsPct*.5),f=Math.min(100,35+t.vault*3);return{type:"polarArea",data:{labels:["DFARS","ITAR","NIST 800-171","CMMC","ISO 27001","SOX"],datasets:[{data:[n,s,c,l,m,f],backgroundColor:["rgba(0,170,255,0.5)","rgba(201,168,76,0.5)","rgba(56,189,248,0.5)","rgba(255,107,107,0.5)","rgba(0,170,255,0.5)","rgba(6,182,212,0.5)"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#8ea4b8",font:{size:9},padding:6}}},scales:{r:{grid:{color:"rgba(255,255,255,0.06)"},ticks:{display:!1}}}}}},roiLineChart:function(){var t=a(),n=t.roiPrograms*t.roiRecords,s=1+Math.sqrt(Math.max(0,n))/50,c=t.roiFTEs*2080*t.roiRate,l=c*.65*s,m=t.roiAudit*.7*Math.max(1,t.roiPrograms/5),f=l+m,b=t.roiLicense||1,p=[],v=[],g=t.roiPrograms>0||t.roiFTEs>0||t.roiLicense>0;if(g)for(var L=0,S=1;S<=5;S++)for(var x=1;x<=4;x++){p.push("Y"+S+"-Q"+x);var k=(S-1)*4+x,q=.2+.65*(1-Math.exp(-.18*k)),D=f/4*q,B=b/4;L+=D-B;var I=b>0?L/b*100:0;v.push(Math.round(I))}if(!g||v.length===0||v.every(function(A){return A===0})){p=[],v=[];for(var C=1;C<=5;C++)for(var T=1;T<=4;T++){p.push("Y"+C+"-Q"+T);var k=(C-1)*4+T;v.push(Math.round(-15+3.5*k+.8*Math.pow(k,1.45)))}}return{type:"line",data:{labels:p,datasets:[{label:"Cumulative ROI %",data:v,borderColor:"#00cc66",backgroundColor:"rgba(0,204,102,0.1)",fill:!0,tension:.3,pointRadius:2,pointBackgroundColor:"#00cc66"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"5-Year Cumulative ROI",color:"#8ea4b8",font:{size:11}}},scales:{x:{ticks:{color:"#8ea4b8",font:{size:8},maxRotation:45},grid:{display:!1}},y:{ticks:{color:"#6b7d93",font:{size:9},callback:function(A){return A+"%"}},grid:{color:"rgba(255,255,255,0.04)"},beginAtZero:!0}}}}},riskHeatChart:function(){var t=a(),n=[];if(t.riskItems.length>0)t.riskItems.forEach(function(m){n.push({x:m.likelihood||Math.ceil(Math.random()*9),y:m.impact||Math.ceil(Math.random()*9)})});else for(var s=Math.max(3,Math.min(12,3+t.vault+t.actions)),c=0;c<s;c++)n.push({x:1+Math.floor(Math.random()*9),y:1+Math.floor(Math.random()*9)});var l=n.map(function(m){var f=m.x*m.y;return f>=50?"rgba(255,70,70,0.8)":f>=25?"rgba(255,165,0,0.7)":f>=10?"rgba(201,168,76,0.6)":"rgba(0,170,255,0.5)"});return{type:"scatter",data:{datasets:[{label:"Risk Items",data:n,backgroundColor:l,borderColor:l,pointRadius:7}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:n.length+" Risk Items Mapped",color:"#8ea4b8",font:{size:11}}},scales:{x:{title:{display:!0,text:"Likelihood →",color:"#8ea4b8",font:{size:9}},ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},min:0,max:10},y:{title:{display:!0,text:"Impact →",color:"#8ea4b8",font:{size:9}},ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},min:0,max:10}}}}},lifecyclePieChart:function(){var t=a(),n=Math.min(30,(t.dmsmsItems.length||0)*5),s=Math.min(15,t.ilsPct*.15);return{type:"line",data:{labels:["Intro","Growth","Maturity","Sustain","Phase Out","Disposal"],datasets:[{label:"Availability %",data:[95-n*.1,92-n*.2+s,88-n*.4+s,75-n*.6+s*2,50-n*.3+s,20+s*.5].map(function(c){return Math.round(Math.max(5,Math.min(100,c)))}),borderColor:"#00aaff",backgroundColor:"rgba(0,170,255,0.1)",fill:!0,tension:.3},{label:"Cost Index",data:[30,25+n*.3,35+n*.5,55+n*.8-s,70+n-s*2,90+n*.5-s].map(function(c){return Math.round(Math.max(5,Math.min(100,c)))}),borderColor:"#ff6b6b",backgroundColor:"rgba(255,107,107,0.05)",fill:!0,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#8ea4b8",font:{size:10}}}},scales:{x:{ticks:{color:"#8ea4b8",font:{size:9}},grid:{display:!1}},y:{ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},beginAtZero:!0}}}}}};window._bpRenderInPanel=d;function d(t){if(!(typeof Chart>"u")){if(typeof injectChartContainers=="function")try{injectChartContainers()}catch{}var n=t.querySelectorAll("canvas");n.length!==0&&n.forEach(function(s){if(!s.getAttribute("data-bp-rendered")){var c=i[s.id];if(c)try{var l=Chart.getChart(s);l&&l.destroy(),!s.style.height&&!s.getAttribute("height")&&(s.style.height="220px"),s.style.width="100%",s.style.display="block";var m=s.closest(".chart-container");m&&(m.style.display="block",m.style.visibility="visible"),new Chart(s,c()),s.setAttribute("data-bp-rendered","1"),s.setAttribute("data-bp-ts",Date.now())}catch{}}})}}function u(){if(r()===0&&(setTimeout(r,2e3),setTimeout(r,5e3)),window.calcROI=o,typeof window.openILSTool=="function"){var t=window.openILSTool;window.openILSTool=function(s){t(s),setTimeout(function(){var c=document.getElementById(s);c&&d(c)},300),setTimeout(function(){var c=document.getElementById(s);c&&d(c)},800),setTimeout(function(){var c=document.getElementById(s);c&&d(c)},2e3)}}if(typeof window.switchHubTab=="function"){var n=window.switchHubTab;window.switchHubTab=function(s,c){n(s,c),setTimeout(function(){var l=document.getElementById(s);l&&d(l)},400)}}document.querySelectorAll(".ils-hub-panel").forEach(function(s){var c=new MutationObserver(function(l){l.forEach(function(m){m.target.classList&&m.target.classList.contains("active")&&setTimeout(function(){d(m.target)},400)})});c.observe(s,{attributes:!0,attributeFilter:["class","style"]})}),setTimeout(function(){document.querySelectorAll(".ils-hub-panel.active").forEach(function(s){d(s)})},2e3),setTimeout(function(){if(typeof loadPerformanceMetrics=="function")try{loadPerformanceMetrics()}catch{}},1500),setTimeout(r,3e3),typeof Q=="function"&&Q()}window._s4RefreshCharts=function(){document.querySelectorAll("canvas[data-bp-rendered]").forEach(function(n){n.removeAttribute("data-bp-rendered")});var t=document.querySelector(".ils-hub-panel.active");t&&d(t)},document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u()})();window.applyRole=ve;window.onRoleToolToggle=pe;window.selectRolePreset=be;
