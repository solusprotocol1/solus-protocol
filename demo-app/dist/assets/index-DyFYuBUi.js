import"./engine-DA9f5wpD.js";import"./navigation-DbWVOe8q.js";import"./metrics-3rj9vPsv.js";import"./enhancements-B4X37-EE.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const l of c)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function o(c){const l={};return c.integrity&&(l.integrity=c.integrity),c.referrerPolicy&&(l.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?l.credentials="include":c.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(c){if(c.ep)return;c.ep=!0;const l=o(c);fetch(c.href,l)}})();document.addEventListener("dragover",function(t){t.preventDefault(),t.stopPropagation()},!1);document.addEventListener("drop",function(t){t.preventDefault(),t.stopPropagation()},!1);window.S4=window.S4||{version:"5.12.0",modules:{},register:function(t,e){this.modules[t]=e},getModule:function(t){return this.modules[t]||null}};S4.i18n={locale:(navigator.language||"en").split("-")[0],catalogs:{en:{"app.name":"S4 Ledger","nav.platform":"Platform","nav.useCases":"Use Cases","nav.pricing":"Pricing","nav.company":"Company","nav.docs":"Docs","nav.requestDemo":"Request Demo","anchor.title":"Anchor Channel","anchor.placeholder":"Or paste/type your defense logistics record here...","anchor.button":"Anchor Record","verify.title":"Verify Channel","verify.placeholder":"Paste the original defense record content here...","vault.title":"Audit Record Vault","vault.empty":"No anchored records yet. Records will appear here automatically as you anchor them.","vault.search":"Search records by type, hash, content...","vault.exportCSV":"Export CSV","vault.exportXLSX":"Export XLSX","vault.reverifyAll":"Re-Verify All","vault.clear":"Clear Vault","toast.missingContent":"Please enter record content.","toast.noProgram":"Please select a program first.","toast.noAnalysis":"Run analysis first.","toast.copied":"Copied to clipboard!","toast.exported":"records exported.","toast.verified":"records re-verified.","shortcuts.title":"Keyboard Shortcuts","search.placeholder":"Search records, vault, tools, documents...","search.noResults":"No results found"}},setLocale:function(t){this.locale=t},t:function(t){var e=this.catalogs[this.locale]||this.catalogs.en;return e[t]||this.catalogs.en[t]||t}};window.S4.t=S4.i18n.t.bind(S4.i18n);window.onerror=function(t,e,o,s,c){return!0};window.addEventListener("unhandledrejection",function(t){});(function(){var t=document.createElement("div");S4.sanitize=function(n){return typeof n!="string"?"":(t.textContent=n,t.innerHTML)},S4.sanitizeHTML=function(n){if(typeof n!="string")return"";var i=document.createElement("div");i.innerHTML=n;for(var r=i.querySelectorAll("script,iframe,object,embed,form"),a=r.length-1;a>=0;a--)r[a].remove();for(var d=i.querySelectorAll("*"),u=0;u<d.length;u++)for(var y=d[u].attributes,m=y.length-1;m>=0;m--)(y[m].name.startsWith("on")||y[m].value.indexOf("javascript:")===0)&&d[u].removeAttribute(y[m].name);return i.innerHTML};var e=1800*1e3,o=null,s=!1;S4.sessionTimeout=e;function c(){s||(clearTimeout(o),o=setTimeout(function(){s=!0,S4.sessionLocked=!0;var n=document.getElementById("s4SessionLockOverlay");n&&(n.style.display="flex"),typeof s4Notify=="function"&&s4Notify("Session Locked","Inactive for 30 minutes. Click to resume.","warning")},e))}S4.resumeSession=function(){s=!1,S4.sessionLocked=!1;var n=document.getElementById("s4SessionLockOverlay");n&&(n.style.display="none"),c()},["mousemove","mousedown","keydown","scroll","touchstart"].forEach(function(n){document.addEventListener(n,c,{passive:!0})}),c();var l=null;S4.crypto={_getKey:async function(){if(l)return l;var n=sessionStorage.getItem("s4_enc_key");if(n){var i=Uint8Array.from(atob(n),function(a){return a.charCodeAt(0)});return l=await crypto.subtle.importKey("raw",i,"AES-GCM",!0,["encrypt","decrypt"]),l}l=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);var r=await crypto.subtle.exportKey("raw",l);return sessionStorage.setItem("s4_enc_key",btoa(String.fromCharCode.apply(null,new Uint8Array(r)))),l},encrypt:async function(n){var i=await this._getKey(),r=crypto.getRandomValues(new Uint8Array(12)),a=new TextEncoder().encode(n),d=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},i,a),u=new Uint8Array(r.length+d.byteLength);return u.set(r),u.set(new Uint8Array(d),r.length),btoa(String.fromCharCode.apply(null,u))},decrypt:async function(n){var i=await this._getKey(),r=Uint8Array.from(atob(n),function(y){return y.charCodeAt(0)}),a=r.slice(0,12),d=r.slice(12),u=await crypto.subtle.decrypt({name:"AES-GCM",iv:a},i,d);return new TextDecoder().decode(u)}},S4.auditChain={computeChainHash:async function(n,i){var r=(i||"0".repeat(64))+"|"+n.hash+"|"+n.timestamp,a=new TextEncoder().encode(r),d=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(d)).map(function(u){return u.toString(16).padStart(2,"0")}).join("")},verifyChain:async function(n){if(!n||n.length===0)return{valid:!0,errors:[]};for(var i=[],r="0".repeat(64),a=0;a<n.length;a++)if(n[a].chainHash){var d=await this.computeChainHash(n[a],r);n[a].chainHash!==d&&i.push({index:a,expected:d,got:n[a].chainHash,record:n[a].label||n[a].type}),r=n[a].chainHash}else r=n[a].hash||r;return{valid:i.length===0,errors:i}}};var f={};S4.rateLimit=function(n,i){i=i||30;var r=Date.now();return f[n]||(f[n]=[]),f[n]=f[n].filter(function(a){return r-a<6e4}),f[n].length>=i?!1:(f[n].push(r),!0)},S4.csrf=(function(){var n=null;function i(){var r=new Uint8Array(32);return crypto.getRandomValues(r),Array.from(r,function(a){return a.toString(16).padStart(2,"0")}).join("")}return{getToken:function(){return n||(n=i()),n},refresh:function(){return n=i(),n},validate:function(r){return r&&r===n},addToHeaders:function(r){return r=r||{},r["X-CSRF-Token"]=this.getToken(),r}}})(),S4.zkVerify=async function(n){var i=typeof s4Vault<"u"&&s4Vault.some(function(y){return y.hash===n}),r={timestamp:new Date().toISOString(),claim:"Record with hash prefix "+n.substring(0,8)+"... exists in vault",verified:i,proofHash:null},a=crypto.getRandomValues(new Uint8Array(16)),d=new TextEncoder().encode(JSON.stringify(r)+Array.from(a).join("")),u=await crypto.subtle.digest("SHA-256",d);return r.proofHash=Array.from(new Uint8Array(u)).map(function(y){return y.toString(16).padStart(2,"0")}).join(""),r},S4.register("security",{version:"1.0.0",features:["xss-sanitizer","session-timeout","encrypted-storage","audit-chain","rate-limiter","zk-verify"]})})();sessionStorage.getItem("s4_entered")==="1"&&(document.getElementById("platformLanding").style.display="none",document.querySelector(".hero").style.display="none",document.getElementById("platformWorkspace").style.display="block");document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector('a[href="#tabWallet"]');t&&t.addEventListener("shown.bs.tab",function(){var e=document.getElementById("demoPanel");e&&(e.style.display="block")}),document.querySelectorAll('.nav-link[data-bs-toggle="pill"]').forEach(function(e){e.getAttribute("href")!=="#tabWallet"&&e.addEventListener("shown.bs.tab",function(){var o=document.getElementById("demoPanel");o&&(o.style.display="none")})})});window.addEventListener("scroll",function(){var t=window.scrollY,e=document.documentElement.scrollHeight-window.innerHeight,o=document.getElementById("scrollProgress");o&&(o.style.width=(e>0?t/e*100:0)+"%");var s=document.getElementById("backToTop");s&&(t>400?(s.style.opacity="1",s.style.visibility="visible"):(s.style.opacity="0",s.style.visibility="hidden"))});var v=new IntersectionObserver(function(t){t.forEach(function(e){e.isIntersecting&&e.target.classList.add("visible")})},{threshold:.1});document.querySelectorAll(".reveal-demo").forEach(function(t){v.observe(t)});function p(){const t=JSON.parse(localStorage.getItem("s4_wallet")||"null"),e=document.getElementById("walletNoWallet"),o=document.getElementById("walletCredentials");if(!t||!t.wallet){e&&(e.style.display="block"),o&&(o.style.display="none");return}e&&(e.style.display="none"),o&&(o.style.display="block"),document.getElementById("walletAddress").textContent=t.wallet.address,document.getElementById("seedRevealed").textContent=t.wallet.seed;const s=t.wallet.network==="mainnet"?"https://livenet.xrpl.org/accounts/":"https://testnet.xrpl.org/accounts/";document.getElementById("demoWalletExplorer").href=s+t.wallet.address,g(t.wallet.address)}async function g(t){try{const r=await(await fetch("/api/wallet/balance?address="+encodeURIComponent(t))).json();if(r.error){document.getElementById("walletSLSBalance").textContent="0",document.getElementById("walletAnchors").textContent="0",document.getElementById("walletXRP").textContent="0";return}document.getElementById("walletSLSBalance").textContent=parseFloat(r.sls_balance).toLocaleString(),document.getElementById("walletSLSUSD").textContent=(parseFloat(r.sls_balance)*r.sls_price_usd).toFixed(2),document.getElementById("walletAnchors").textContent=r.anchors_available.toLocaleString(),document.getElementById("walletXRP").textContent=r.xrp_balance.toFixed(2),document.getElementById("walletNetwork").textContent="XRPL "+r.network.charAt(0).toUpperCase()+r.network.slice(1)}catch{if(_demoSession&&_demoSession.subscription){var e=_demoSession.subscription.sls_allocation||25e3,o=typeof stats<"u"&&stats.slsFees||0,s=Math.round((e-o)*100)/100,c=document.getElementById("walletSLSBalance");c&&(c.textContent=s.toLocaleString(void 0,{maximumFractionDigits:2}));var l=document.getElementById("walletAnchors");l&&(l.textContent=Math.floor(s/.01).toLocaleString());var f=document.getElementById("walletXRP");f&&(f.textContent="12.00");var n=document.getElementById("walletNetwork");n&&(n.textContent="XRPL Mainnet (Demo)")}}}function b(){const t=document.getElementById("seedMasked"),e=document.getElementById("seedRevealed"),o=document.getElementById("seedToggleBtn");e.style.display==="none"?(e.style.display="inline",t.style.display="none",o.innerHTML='<i class="fas fa-eye-slash"></i> Hide'):(e.style.display="none",t.style.display="inline",o.innerHTML='<i class="fas fa-eye"></i> Show')}function w(t){const e=document.getElementById(t).textContent;navigator.clipboard.writeText(e).then(()=>{const o=document.getElementById(t).parentElement.querySelector("button"),s=o.innerHTML;o.innerHTML='<i class="fas fa-check"></i>',setTimeout(()=>{o.innerHTML=s},1200)})}function S(t,e){document.getElementById("slsUsdInput").value=t,h(),document.querySelectorAll(".sls-amt-btn").forEach(o=>{o.style.borderColor="var(--border)",o.style.background="var(--surface)",o.style.color="var(--steel)"}),e&&(e.style.borderColor="rgba(0,170,255,0.5)",e.style.background="rgba(0,170,255,0.08)",e.style.color="var(--accent)")}function h(){const t=parseFloat(document.getElementById("slsUsdInput").value)||0,e=Math.round(t/.01);document.getElementById("slsPreviewTokens").textContent=e.toLocaleString()+" Credits",document.getElementById("slsPreviewAnchors").textContent=(e*100).toLocaleString()}async function E(){const t=JSON.parse(localStorage.getItem("s4_wallet")||"null"),e=document.getElementById("buySLSResult"),o=document.getElementById("buySLSBtn");if(!t||!t.wallet){e.style.display="block",e.style.background="rgba(255,51,51,0.08)",e.style.border="1px solid rgba(255,51,51,0.2)",e.style.color="#ff6b6b",e.innerHTML='<i class="fas fa-exclamation-circle" style="margin-right:6px"></i>Please <a href="/s4-login/" style="color:var(--accent)">create an account</a> first to get a wallet.';return}const s=parseFloat(document.getElementById("slsUsdInput").value)||0;if(s<=0){e.style.display="block",e.style.background="rgba(255,51,51,0.08)",e.style.border="1px solid rgba(255,51,51,0.2)",e.style.color="#ff6b6b",e.textContent="Please enter a valid amount.";return}o.disabled=!0,o.innerHTML='<i class="fas fa-spinner fa-spin"></i> Processing...',e.style.display="none";try{const l=await(await fetch("/api/wallet/buy-sls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wallet_address:t.wallet.address,usd_amount:s,payment_method:"card"})})).json();l.error?(e.style.display="block",e.style.background="rgba(255,51,51,0.08)",e.style.border="1px solid rgba(255,51,51,0.2)",e.style.color="#ff6b6b",e.innerHTML='<i class="fas fa-exclamation-circle" style="margin-right:6px"></i>'+l.error):(e.style.display="block",e.style.background="rgba(0,170,255,0.2)",e.style.border="1px solid rgba(0,170,255,0.2)",e.style.color="#00aaff",e.innerHTML='<i class="fas fa-check-circle" style="margin-right:6px"></i>Purchased '+parseFloat(l.purchase.sls_received).toLocaleString()+" Credits for $"+l.purchase.usd_paid.toFixed(2)+'! <a href="'+l.explorer_url+'" target="_blank" style="color:var(--accent);margin-left:8px">View TX <i class="fas fa-external-link-alt" style="font-size:0.7rem"></i></a>',g(t.wallet.address))}catch(c){e.style.display="block",e.style.background="rgba(255,51,51,0.08)",e.style.border="1px solid rgba(255,51,51,0.2)",e.style.color="#ff6b6b",e.innerHTML='<i class="fas fa-exclamation-circle" style="margin-right:6px"></i>Network error: '+c.message}o.disabled=!1,o.innerHTML='<i class="fas fa-credit-card" style="margin-right:6px"></i> Purchase with Card'}function L(t){document.querySelectorAll(".chart-range-btn").forEach(s=>{s.style.background="var(--surface)",s.style.border="1px solid var(--border)",s.style.color="var(--steel)",s.style.fontWeight="400"});const e=document.getElementById("chart"+t.charAt(0).toUpperCase()+t.slice(1));e&&(e.style.background="rgba(26,58,92,0.2)",e.style.border="1px solid rgba(201,168,76,0.3)",e.style.color="#00aaff",e.style.fontWeight="700");const o=document.getElementById("chartOverlay");o&&(o.querySelector("p").textContent="Showing "+t+" usage data. Chart populates as records are anchored.")}setTimeout(function(){var t=document.getElementById("platformWorkspace");t&&t.style.display==="block"&&typeof loadPerformanceMetrics=="function"&&loadPerformanceMetrics().catch(function(e){})},2e3);document.addEventListener("shown.bs.tab",function(t){t.target.getAttribute("href")==="#tabWallet"&&p()});window.location.hash==="#tabWallet"&&document.addEventListener("DOMContentLoaded",()=>setTimeout(p,500));window.copyWalletField=w;window.handleBuySLS=E;window.setChartRange=L;window.setSLSAmount=S;window.toggleSeed=b;window.updateSLSPreview=h;
