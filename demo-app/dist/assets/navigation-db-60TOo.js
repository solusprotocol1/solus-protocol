var E=0,G=localStorage.getItem("s4_selected_tier")||"starter",R={pilot:{label:"Pilot (Free)",sls:100,price:"Free"},starter:{label:"Starter ($999/mo)",sls:25e3,price:"$999/mo"},professional:{label:"Professional ($2,499/mo)",sls:1e5,price:"$2,499/mo"},enterprise:{label:"Enterprise ($9,999/mo)",sls:5e5,price:"$9,999/mo"}};function V(){var e=document.getElementById("onboardOverlay");e&&(e.style.display="flex",typeof _s4TrapFocus=="function"&&_s4TrapFocus(e)),E=0,Z()}function N(){var e=document.getElementById("onboardOverlay");e&&(e.style.display="none"),typeof _s4ReleaseFocusTrap=="function"&&_s4ReleaseFocusTrap(),sessionStorage.setItem("s4_onboard_done","1"),setTimeout(function(){typeof _currentRole<"u"&&!_currentRole&&typeof showRoleSelector=="function"&&showRoleSelector()},500),localStorage.setItem("s4_selected_tier",G),_demoSession=null,typeof _initDemoSession=="function"&&_initDemoSession()}function J(){if(E++,E>4){N();return}Z(),E===1&&oe(),E===2&&ae()}function Z(){for(var e=0;e<=4;e++){var a=document.getElementById("onboardStep"+e);a&&a.classList.toggle("active",e===E)}var o=document.querySelectorAll("#onboardProgress .onboard-dot");o.forEach(function(r,c){r.classList.remove("active","done"),c===E?r.classList.add("active"):c<E&&r.classList.add("done")})}function oe(){var e=document.getElementById("onboardAcctStatus"),a=document.getElementById("onboardAcctId"),o=document.getElementById("onboardAcctDone");a&&(a.textContent="demo_"+Date.now().toString(36)),setTimeout(function(){e&&(e.innerHTML='<i class="fas fa-check-circle" style="color:var(--green)"></i> Active'),o&&(o.style.display="block")},1200)}function ae(){for(var e=document.getElementById("onboardWalletAddr"),a=document.getElementById("onboardXrpBal"),o=document.getElementById("onboardTrustLine"),r=document.getElementById("onboardWalletDone"),c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",f="r",m=0;m<28;m++)f+=c[Math.floor(Math.random()*c.length)];setTimeout(function(){e&&(e.textContent=f.substring(0,8)+"..."+f.slice(-4))},500),setTimeout(function(){a&&(a.textContent="12.000000 XRP")},1200),setTimeout(function(){o&&(o.innerHTML='Credits <i class="fas fa-check-circle" style="color:var(--green);margin-left:4px"></i>'),r&&(r.style.display="block")},1800)}function Q(e,a){G=a;var o=(R[a]||R.starter).sls,r=document.getElementById("demoStep3Status");r&&r.innerHTML.indexOf("Credits")!==-1&&(r.innerHTML='<i class="fas fa-check" style="color:#00aaff;margin-right:3px;"></i> '+o.toLocaleString()+" Credits");var c=document.getElementById("demoSlsBalance");c&&(c.textContent=o.toLocaleString()+" Credits"),_demoSession&&_demoSession.subscription&&(_demoSession.subscription.sls_allocation=o,_demoSession.subscription.label=(R[a]||R.starter).label),document.querySelectorAll(".onboard-tier").forEach(function(s){s.classList.remove("selected")}),e.classList.add("selected");var f=R[a],m=document.getElementById("onboardSlsBal"),t=document.getElementById("onboardSlsAnchors");m&&(m.textContent=f.sls.toLocaleString()),t&&(t.textContent=(f.sls*100).toLocaleString());var i=document.getElementById("slsBarBalance");i&&(i.textContent=f.sls.toLocaleString()+" Credits");var n=document.getElementById("toolSlsBal");n&&(n.textContent=f.sls.toLocaleString());var l=document.getElementById("sidebarSlsBal");l&&(l.textContent=f.sls.toLocaleString()+" Credits")}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("platformWorkspace");e&&e.style.display==="block"&&!sessionStorage.getItem("s4_onboard_done")&&setTimeout(V,600)});window.showOnboarding=V;window.closeOnboarding=N;window.onboardNext=J;window.selectOnboardTier=Q;(function(){function a(){document.querySelectorAll(".onboard-btn").forEach(function(r){r._s4ob||(r._s4ob=!0,r.addEventListener("click",function(c){c.stopPropagation();var f=(this.textContent||"").toLowerCase();f.indexOf("enter")!==-1?(sessionStorage.setItem("s4_entered","1"),N()):J()}))}),document.querySelectorAll(".onboard-tier").forEach(function(r){r._s4ob||(r._s4ob=!0,r.addEventListener("click",function(c){c.stopPropagation();var f=this.getAttribute("data-tier")||"starter";Q(this,f)}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a();var o=setInterval(function(){var r=document.getElementById("onboardOverlay");r&&r.style.display==="flex"&&(a(),clearInterval(o))},200);setTimeout(function(){clearInterval(o)},3e4)})();(function(){if(sessionStorage.getItem("s4_onboard_done"))return;var a=0;function o(){a++;var r=document.getElementById("platformWorkspace");if(r&&r.style.display==="block"&&!sessionStorage.getItem("s4_onboard_done")){V();return}a<300&&setTimeout(o,100)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){setTimeout(o,200)}):setTimeout(o,200)})();var _=null;function re(){document.querySelectorAll(".tab-pane").forEach(function(i){i.classList.remove("show","active"),i.style.display="none"});var e=document.getElementById("sectionSystems");e&&(e.style.display="none"),document.querySelectorAll(".ils-hub-panel").forEach(function(i){i.classList.remove("active"),i.style.display="none"});var a=document.getElementById("ilsToolBackBar");a&&(a.style.display="none");var o=document.getElementById("ilsSubHub");o&&(o.style.display="grid");var r=document.querySelector(".ils-hub-tabs");r&&(r.style.display="none"),_=null;var c=document.getElementById("platformHub");c&&(c.style.display="block",c.style.animation="fadeIn 0.3s ease");var f=document.getElementById("statsRow");if(f&&(f.style.display="flex"),!sessionStorage.getItem("s4_entered")){var m=document.querySelector(".hero");m&&(m.style.display="block");var t=document.getElementById("platformLanding");t&&(t.style.display="block")}history.replaceState(null,"",window.location.pathname)}function F(e){var a=document.getElementById("platformHub");a&&(a.style.display="none");var o=document.querySelector(".hero");o&&(o.style.display="none");var r=document.getElementById("platformLanding");r&&(r.style.display="none"),document.querySelectorAll(".tab-pane").forEach(function(s){s.classList.remove("show","active"),s.style.display="none"});var c=document.getElementById("sectionSystems");c&&(c.style.display="none");var f={sectionAnchor:"tabAnchor",sectionVerify:"tabVerify",sectionLog:"tabLog",sectionILS:"tabILS",sectionSystems:"sectionSystems",sectionMetrics:"tabMetrics",sectionOffline:"tabOffline"};if(e==="sectionSystems")c&&(c.style.display="block",c.classList.add("show","active"),c.style.animation="fadeIn 0.3s ease");else{var m=f[e]||e,t=document.getElementById(m);t&&(t.style.display="block",t.classList.add("show","active"),t.style.animation="fadeIn 0.3s ease");var i=document.querySelector('a[href="#'+m+'"]');if(i)try{new bootstrap.Tab(i).show()}catch{}}if(e==="sectionILS"){var n=document.getElementById("ilsSubHub");n&&(n.style.display="grid");var l=document.getElementById("ilsToolBackBar");l&&(l.style.display="none"),document.querySelectorAll(".ils-hub-panel").forEach(function(s){s.classList.remove("active")})}}function ie(e){var a=document.getElementById("sectionSystems");a&&(a.style.display="none");var o=document.getElementById(e);o&&(o.style.display="block",o.classList.add("show","active"),o.style.animation="fadeIn 0.3s ease")}function W(e){var a=document.getElementById("ilsSubHub");a&&(a.style.display="none");var o=document.getElementById("ilsToolBackBar");o&&(o.style.display="block"),document.querySelectorAll(".ils-hub-panel").forEach(function(f){f.classList.remove("active"),f.style.display="none"});var r=document.getElementById(e);r&&(r.style.display="block",r.classList.add("active"),r.style.animation="fadeIn 0.3s ease");var c=document.querySelector('.ils-hub-tab[onclick*="'+e+'"]');c&&(document.querySelectorAll(".ils-hub-tab").forEach(function(f){f.classList.remove("active")}),c.classList.add("active")),e==="hub-actions"&&(typeof renderHubActions=="function"&&renderHubActions(),typeof renderActionCalendar=="function"&&(setTimeout(renderActionCalendar,200),setTimeout(renderActionCalendar,600))),e==="hub-vault"&&typeof renderVault=="function"&&renderVault(),e==="hub-docs"&&typeof renderDocLibrary=="function"&&renderDocLibrary(),e==="hub-compliance"&&typeof calcCompliance=="function"&&calcCompliance(),e==="hub-risk"&&typeof loadRiskData=="function"&&loadRiskData(),e==="hub-roi"&&typeof calcROI=="function"&&calcROI(),e==="hub-reports"&&typeof loadReportPreview=="function"&&loadReportPreview(),e==="hub-predictive"&&typeof loadPredictiveData=="function"&&loadPredictiveData(),e==="hub-submissions"&&typeof loadSubmissionHistory=="function"&&loadSubmissionHistory(),e==="hub-sbom"&&typeof loadSBOMData=="function"&&loadSBOMData(),e==="hub-dmsms"&&typeof loadDMSMSData=="function"&&loadDMSMSData(),e==="hub-readiness"&&typeof loadReadinessData=="function"&&loadReadinessData(),e==="hub-lifecycle"&&typeof calcLifecycle=="function"&&calcLifecycle(),e==="hub-analysis"&&typeof initILSChecklist=="function"&&initILSChecklist(),typeof updateAiContext=="function"&&updateAiContext(e),(function(){var f=document.getElementById(e);if(!f)return;var m=f.querySelector("details");if(!m)return;m.style.display="none";var t="s4_hiw_"+e;function i(){var s=document.querySelector(".hiw-modal-overlay");s&&s.remove();var u=m.querySelector("summary")?m.querySelector("summary").textContent.replace(/[▸▾▾]/g,"").trim():"How It Works",d="";m.querySelectorAll("p,ol,ul,li").forEach(function(b){d+=b.outerHTML}),d||(d=m.innerHTML.replace(/<summary[^>]*>.*?<\/summary>/i,""));var p=document.createElement("div");p.className="hiw-modal-overlay",p.innerHTML='<div class="hiw-modal-box"><button class="hiw-close" title="Close">&times;</button><h4><i class="fas fa-info-circle" style="margin-right:6px"></i>'+u+'</h4><div class="hiw-body">'+d+"</div></div>",p.querySelector(".hiw-close").onclick=function(){p.remove()},p.onclick=function(b){b.target===p&&p.remove()},document.body.appendChild(p)}localStorage.getItem(t)||(localStorage.setItem(t,"1"),setTimeout(i,300));var n=f.querySelector("h3");if(n&&!n.querySelector(".hiw-help-btn")){var l=document.createElement("button");l.className="hiw-help-btn",l.title="How It Works",l.textContent="?",l.style.cssText="margin-left:8px;background:rgba(0,170,255,0.12);border:1px solid rgba(0,170,255,0.3);color:#00aaff;border-radius:50%;width:22px;height:22px;font-size:0.72rem;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;",l.onclick=function(s){s.stopPropagation(),i()},n.appendChild(l)}})(),_=e}function ne(){document.querySelectorAll(".ils-hub-panel").forEach(function(c){c.classList.remove("active"),c.style.display="none"});var e=document.getElementById("ilsSubHub");e&&(e.style.display="grid",e.style.animation="fadeIn 0.3s ease");var a=document.getElementById("ilsToolBackBar");a&&(a.style.display="none");var o=document.querySelector(".ils-hub-tabs");if(o&&(o.style.display="none"),_=null,_currentRole&&typeof applyTabVisibility=="function"){var r=_customVisibleTabs||(_s4Roles[_currentRole]?_s4Roles[_currentRole].tabs:_allHubTabs);applyTabVisibility(r)}}(function(){var a="s4_demo_tool_card_order";function o(){return document.getElementById("ilsSubHub")}function r(){var m=o();if(m){var t=localStorage.getItem(a);if(t)try{var i=JSON.parse(t),n=Array.from(m.querySelectorAll(".ils-tool-card")),l={};n.forEach(function(s){var u=s.getAttribute("onclick")||"",d=(u.match(/openILSTool\('([^']+)'\)/)||[])[1];d&&(l[d]=s)}),i.forEach(function(s){l[s]&&m.appendChild(l[s])})}catch{}}}function c(){var m=o();if(m){var t=m.querySelectorAll(".ils-tool-card"),i=[];t.forEach(function(n){var l=n.getAttribute("onclick")||"",s=(l.match(/openILSTool\('([^']+)'\)/)||[])[1];s&&i.push(s)}),localStorage.setItem(a,JSON.stringify(i))}}function f(){var m=o();if(m){var t=null;m.querySelectorAll(".ils-tool-card").forEach(function(i){i.setAttribute("draggable","true"),i.addEventListener("dragstart",function(d){t=this,this.classList.add("dragging"),d.dataTransfer.effectAllowed="move",d.dataTransfer.setData("text/plain","")}),i.addEventListener("dragend",function(){this.classList.remove("dragging"),m.querySelectorAll(".ils-tool-card").forEach(function(d){d.classList.remove("drag-over")})}),i.addEventListener("dragover",function(d){d.preventDefault(),d.dataTransfer.dropEffect="move",this!==t&&this.classList.add("drag-over")}),i.addEventListener("dragleave",function(){this.classList.remove("drag-over")}),i.addEventListener("drop",function(d){if(d.preventDefault(),this.classList.remove("drag-over"),t&&t!==this){var p=Array.from(m.querySelectorAll(".ils-tool-card")),b=p.indexOf(t),v=p.indexOf(this);b<v?m.insertBefore(t,this.nextSibling):m.insertBefore(t,this),c(),f()}t=null});var n=null,l=!1,s=null,u=null;i.addEventListener("touchstart",function(d){var p=this;n=setTimeout(function(){l=!0,u=p,p.classList.add("dragging"),s=p.cloneNode(!0),s.style.position="fixed",s.style.pointerEvents="none",s.style.opacity="0.85",s.style.zIndex="9999",s.style.width=p.offsetWidth+"px",s.style.transform="scale(1.05)",s.style.boxShadow="0 8px 32px rgba(0,170,255,0.3)",document.body.appendChild(s)},500)},{passive:!0}),i.addEventListener("touchmove",function(d){if(!(!l||!s)){d.preventDefault();var p=d.touches[0];s.style.left=p.clientX-s.offsetWidth/2+"px",s.style.top=p.clientY-s.offsetHeight/2+"px",m.querySelectorAll(".ils-tool-card").forEach(function(h){h.classList.remove("drag-over")});var b=document.elementFromPoint(p.clientX,p.clientY);if(b){var v=b.closest(".ils-tool-card");v&&v!==u&&v.classList.add("drag-over")}}},{passive:!1}),i.addEventListener("touchend",function(d){if(clearTimeout(n),l&&u){var p=d.changedTouches[0],b=document.elementFromPoint(p.clientX,p.clientY),v=b?b.closest(".ils-tool-card"):null;if(v&&v!==u){var h=Array.from(m.querySelectorAll(".ils-tool-card")),B=h.indexOf(u),S=h.indexOf(v);B<S?m.insertBefore(u,v.nextSibling):m.insertBefore(u,v),c(),f()}u.classList.remove("dragging"),m.querySelectorAll(".ils-tool-card").forEach(function(x){x.classList.remove("drag-over")})}s&&s.parentNode&&s.parentNode.removeChild(s),l=!1,s=null,u=null}),i.addEventListener("touchcancel",function(){clearTimeout(n),s&&s.parentNode&&s.parentNode.removeChild(s),u&&u.classList.remove("dragging"),m.querySelectorAll(".ils-tool-card").forEach(function(d){d.classList.remove("drag-over")}),l=!1,s=null,u=null})})}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){r(),f()}):(r(),f())})();function se(){var e=document.getElementById("walletSidebar"),a=document.getElementById("walletOverlay");e&&e.classList.add("open"),a&&a.classList.add("show");var o=document.getElementById("walletSidebarBody"),r=document.getElementById("tabWallet");o&&r&&!o.dataset.loaded&&(o.innerHTML=r.innerHTML,o.dataset.loaded="true",typeof loadWalletData=="function"&&loadWalletData(),le(o)),U()}function le(e){var a=e.querySelector("#slsToggleBtn");if(a){a.removeAttribute("onclick");var o=document.createElement("div");o.id="sidebarFlowPanel",o.style.cssText="display:none;margin-top:12px;background:linear-gradient(135deg,rgba(0,170,255,0.06),rgba(201,168,76,0.04));border:1px solid rgba(0,170,255,0.25);border-radius:3px;padding:16px 18px;",o.innerHTML='<div style="position:relative"><div style="position:absolute;top:-4px;right:0;background:linear-gradient(135deg,#00aaff,#c9a84c);padding:3px 12px;border-radius:0 10px 0 8px;font-size:0.62rem;font-weight:700;color:#050810;letter-spacing:0.5px">LIVE PREVIEW</div><h4 style="margin:0 0 4px;font-size:0.95rem;color:#fff"><i class="fas fa-flask" style="color:#00aaff;margin-right:6px"></i>Credit Economic Flow</h4><p style="color:#8ea4b8;font-size:0.72rem;margin:0 0 12px">See how the Credits token economy works. <strong style="color:#c9a84c">Every anchor costs 0.01 Credits.</strong></p><div style="display:grid;grid-template-columns:1fr 1fr;gap:8px"><div style="background:rgba(0,170,255,0.08);border:1px solid rgba(0,170,255,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(0,170,255,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-user-plus" style="color:#00aaff;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">1. Account</div><div style="font-size:0.62rem;color:#8ea4b8">Created &amp; provisioned</div></div><div style="background:rgba(0,170,255,0.08);border:1px solid rgba(0,170,255,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(0,170,255,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-wallet" style="color:#00aaff;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">2. Wallet Funded</div><div style="font-size:0.62rem;color:#8ea4b8">12 XRP reserve</div></div><div style="background:rgba(201,168,76,0.08);border:1px solid rgba(201,168,76,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(201,168,76,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-coins" style="color:#c9a84c;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">3. Credits Allocated</div><div style="font-size:0.62rem;color:#8ea4b8">Based on plan tier</div></div><div style="background:rgba(0,170,255,0.08);border:1px solid rgba(0,170,255,0.2);border-radius:3px;padding:10px;text-align:center"><div style="width:28px;height:28px;border-radius:50%;background:rgba(0,170,255,0.15);display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px"><i class="fas fa-arrow-right" style="color:#00aaff;font-size:0.75rem"></i></div><div style="font-size:0.68rem;font-weight:700;color:#fff">4. 0.01 Credits &rarr; Treasury</div><div style="font-size:0.62rem;color:#8ea4b8">Per anchor fee</div></div></div><div style="margin-top:10px;padding:8px 12px;background:rgba(0,0,0,0.25);border-radius:3px;font-size:0.7rem"><div style="display:flex;justify-content:space-between;flex-wrap:wrap;gap:6px"><div><span style="color:#8ea4b8">Wallet:</span> <span style="color:#00aaff;font-family:monospace" id="sidebarWalletAddr">rMLmk...f1KLqJ</span></div><div><span style="color:#8ea4b8">Balance:</span> <span style="color:#c9a84c;font-weight:700" id="sidebarSlsBal">'+(document.getElementById("slsBarBalance")?document.getElementById("slsBarBalance").textContent:"25,000")+" Credits</span></div></div></div></div>";var r=e.querySelector("#slsBalanceBar");r?r.parentNode.insertBefore(o,r.nextSibling):e.insertBefore(o,e.firstChild?e.firstChild.nextSibling:null);var c=!1;a.addEventListener("click",function(){c=!c,o.style.display=c?"block":"none",a.innerHTML=c?'<i class="fas fa-chevron-up" style="margin-right:4px"></i>Hide Flow Details':'<i class="fas fa-chart-simple" style="margin-right:4px"></i>Show Flow Details'})}}function ce(){var e=document.getElementById("walletSidebar"),a=document.getElementById("walletOverlay");e&&e.classList.remove("open"),a&&a.classList.remove("show")}function U(){var e=document.getElementById("slsBarBalance"),a=document.getElementById("walletTriggerBal");e&&a&&(a.textContent=e.textContent||"--")}document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){var e=document.getElementById("platformHub");e&&(e.style.display="block"),document.querySelectorAll(".tab-pane").forEach(function(o){o.classList.remove("show","active"),o.style.display="none"});var a=document.getElementById("demoPanel");a&&(a.style.display="none")},100)});document.addEventListener("shown.bs.tab",function(e){U()});(function(){function e(){var o=document.getElementById("actionItemBadge");if(o){var r=0;typeof s4ActionItems<"u"&&Array.isArray(s4ActionItems)&&(r=s4ActionItems.filter(function(c){return!c.done}).length),r>0?(o.textContent=r,o.style.display="inline-flex"):o.style.display="none"}}setInterval(e,3e3),document.addEventListener("DOMContentLoaded",function(){setTimeout(e,2e3)});var a=F;F=function(o){a(o),setTimeout(e,500)}})();(function(){function e(){var o=document.getElementById("slsBarBalance"),r=document.getElementById("slsBarAnchors"),c=document.getElementById("slsBarSpent"),f=document.getElementById("toolSlsBal"),m=document.getElementById("toolSlsAnch"),t=document.getElementById("toolSlsSpent");f&&o&&(f.textContent=o.textContent.replace(" Credits","")),m&&r&&(m.textContent=r.textContent),t&&c&&(t.textContent=c.textContent.replace(" Credits",""))}setInterval(e,2e3);var a=W;W=function(o){a(o),setTimeout(e,200)}})();(function(){var e=hideAnchorAnimation;hideAnchorAnimation=function(){if(e(),_){var a=document.getElementById(_);if(!a)return;var o=a.querySelector(".anchor-confirm-banner");o&&o.remove();var r=s4Vault.length>0?s4Vault[0]:null;if(!r)return;var c=document.createElement("div");c.className="anchor-confirm-banner",c.style.cssText="background:linear-gradient(135deg,rgba(0,204,102,0.08),rgba(0,170,255,0.06));border:1px solid rgba(0,204,102,0.2);border-radius:3px;padding:16px 20px;margin-bottom:16px;animation:panelSlideIn 0.4s ease;position:relative",c.innerHTML='<button onclick="this.parentElement.remove()" style="position:absolute;top:8px;right:12px;background:none;border:none;color:var(--muted);cursor:pointer;font-size:0.85rem">&times;</button><div style="display:flex;align-items:center;gap:8px;margin-bottom:8px"><i class="fas fa-check-circle" style="color:#00cc66;font-size:1.1rem"></i><strong style="color:#fff;font-size:0.9rem">Record Anchored Successfully</strong></div><div style="font-size:0.78rem;color:var(--steel);display:grid;grid-template-columns:80px 1fr;gap:4px 12px"><span style="color:var(--muted)">Type:</span><span>'+(r.label||r.type)+'</span><span style="color:var(--muted)">Hash:</span><span style="font-family:monospace;color:var(--accent);font-size:0.72rem;word-break:break-all">'+(r.hash||"").substring(0,32)+'...</span><span style="color:var(--muted)">TX:</span><span>'+(r.txHash?'<a href="'+(r.explorerUrl||"#")+'" target="_blank" style="color:var(--accent);text-decoration:none">'+r.txHash.substring(0,16)+'... <i class="fas fa-external-link-alt" style="font-size:0.6rem"></i></a>':"Pending")+'</span><span style="color:var(--muted)">Fee:</span><span style="color:#c9a84c">0.01 Credits</span><span style="color:var(--muted)">Time:</span><span>'+new Date().toLocaleTimeString()+"</span></div>";var f=a.querySelector(".demo-card");f&&f.insertBefore(c,f.firstChild),setTimeout(function(){c.parentElement&&c.remove()},15e3)}}})();document.addEventListener("DOMContentLoaded",function(){["tabAnchor","tabVerify"].forEach(function(e){var a=document.getElementById(e);if(!a)return;var o=a.querySelector("details");if(!o)return;o.style.display="none";var r="s4_hiw_"+e;function c(){var t=document.querySelector(".hiw-modal-overlay");t&&t.remove();var i=o.querySelector("summary")?o.querySelector("summary").textContent.replace(/[▸▾]/g,"").trim():"How It Works",n="";o.querySelectorAll("p,ol,ul,li").forEach(function(s){n+=s.outerHTML}),n||(n=o.innerHTML.replace(/<summary[^>]*>.*?<\/summary>/i,""));var l=document.createElement("div");l.className="hiw-modal-overlay",l.innerHTML='<div class="hiw-modal-box"><button class="hiw-close" title="Close">&times;</button><h4><i class="fas fa-info-circle" style="margin-right:6px"></i>'+i+'</h4><div class="hiw-body">'+n+"</div></div>",l.querySelector(".hiw-close").onclick=function(){l.remove()},l.onclick=function(s){s.target===l&&l.remove()},document.body.appendChild(l)}var f=a.querySelector("h3");if(f&&!f.querySelector(".hiw-help-btn")){var m=document.createElement("button");m.className="hiw-help-btn",m.title="How It Works",m.textContent="?",m.style.cssText="margin-left:8px;background:rgba(0,170,255,0.12);border:1px solid rgba(0,170,255,0.3);color:#00aaff;border-radius:50%;width:22px;height:22px;font-size:0.72rem;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;",m.onclick=function(t){t.stopPropagation(),c()},f.appendChild(m)}document.addEventListener("shown.bs.tab",function(t){var i=t.target.getAttribute("href")||t.target.getAttribute("data-bs-target");i==="#"+e&&!localStorage.getItem(r)&&(localStorage.setItem(r,"1"),setTimeout(c,300))})})});window.closeILSTool=ne;window.closeWalletSidebar=ce;window.openILSTool=W;window.openWalletSidebar=se;window.showHub=re;window.showSection=F;window.showSystemsSub=ie;var g={ils_manager:{label:"ILS Manager",icon:"fa-clipboard-list",desc:"Full ILS tool suite access",tabs:["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team"]},dmsms_analyst:{label:"DMSMS Analyst",icon:"fa-microchip",desc:"DMSMS tracking and obsolescence management",tabs:["hub-dmsms","hub-risk","hub-lifecycle","hub-actions","hub-vault","hub-docs","hub-reports"]},auditor:{label:"Auditor / Compliance",icon:"fa-shield-halved",desc:"Compliance scorecard and audit vault",tabs:["hub-compliance","hub-vault","hub-actions","hub-docs","hub-reports","hub-submissions"]},contracts:{label:"Contract Specialist",icon:"fa-file-contract",desc:"ROI, submissions, and document management",tabs:["hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-actions","hub-cdrl","hub-contract"]},supply_chain:{label:"Supply Chain / Provisioning",icon:"fa-truck",desc:"Supply, readiness, and provisioning tools",tabs:["hub-readiness","hub-risk","hub-lifecycle","hub-actions","hub-vault","hub-docs","hub-submissions"]},admin:{label:"Full Access Admin",icon:"fa-user-shield",desc:"All tools visible — unrestricted access",tabs:["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team"]}},$=["hub-analysis","hub-dmsms","hub-readiness","hub-compliance","hub-risk","hub-actions","hub-predictive","hub-lifecycle","hub-roi","hub-vault","hub-docs","hub-reports","hub-submissions","hub-sbom","hub-gfp","hub-cdrl","hub-contract","hub-provenance","hub-analytics","hub-team"],de={"hub-analysis":"Gap Analysis","hub-dmsms":"DMSMS Tracker","hub-readiness":"Readiness Calc","hub-compliance":"Compliance","hub-risk":"Supply Chain Risk","hub-actions":"Action Items","hub-predictive":"Predictive Maint","hub-lifecycle":"Lifecycle Cost","hub-roi":"ROI Calculator","hub-vault":"Audit Vault","hub-docs":"Document Library","hub-reports":"Report Gen","hub-submissions":"Submissions & PTD","hub-sbom":"SBOM Viewer","hub-gfp":"GFP Tracker","hub-cdrl":"CDRL Validator","hub-contract":"Contract Extractor","hub-provenance":"Provenance Chain","hub-analytics":"Cross-Program Analytics","hub-team":"Team Management"},y=sessionStorage.getItem("s4_user_role")||"",q=sessionStorage.getItem("s4_user_title")||"",k=JSON.parse(sessionStorage.getItem("s4_visible_tabs")||"null");function K(){var e=document.createElement("div");e.id="roleModal",e.style.cssText="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);z-index:10000;display:flex;align-items:center;justify-content:center;animation:fadeIn 0.3s ease";var a='<div style="background:var(--card);border:1px solid var(--border);border-radius:3px;padding:32px;max-width:620px;width:95%;max-height:85vh;overflow-y:auto"><h3 style="color:#fff;margin:0 0 4px"><i class="fas fa-user-cog" style="color:var(--accent);margin-right:8px"></i>Configure Your Role</h3><p style="color:var(--steel);font-size:0.85rem;margin-bottom:20px">Select your role to see relevant tools. You can customize visible tools and your displayed title.</p><div style="margin-bottom:16px"><label style="color:var(--steel);font-size:0.8rem;font-weight:600">Your Display Title</label><input id="roleTitle" value="'+(q||"")+'" style="background:#0a0e1a;color:#fff;border:1px solid rgba(255,255,255,0.15);border-radius:3px;padding:10px;width:100%;margin-top:4px" placeholder="e.g., ILS Analyst, Logistics Specialist, Contract Manager"></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px">';Object.keys(g).forEach(function(o){var r=g[o],c=y===o?"border-color:var(--accent);background:rgba(0,170,255,0.08)":"";a+=`<div class="role-card" onclick="selectRolePreset('`+o+`')" style="border:2px solid `+(c?"var(--accent)":"var(--border)")+";border-radius:3px;padding:14px;cursor:pointer;transition:all 0.2s;"+(c?"background:rgba(0,170,255,0.08)":"")+'" data-role="'+o+'"><div style="display:flex;align-items:center;gap:8px;margin-bottom:6px"><i class="fas '+r.icon+'" style="color:var(--accent);font-size:1.1rem"></i><strong style="color:#fff;font-size:0.9rem">'+r.label+'</strong></div><div style="color:var(--steel);font-size:0.78rem">'+r.desc+'</div><div style="color:var(--muted);font-size:0.72rem;margin-top:4px">'+r.tabs.length+" tools</div></div>"}),a+='</div><details style="margin-bottom:20px;background:rgba(0,170,255,0.03);border:1px solid rgba(0,170,255,0.12);border-radius:3px;padding:0 16px"><summary style="cursor:pointer;color:var(--accent);font-weight:600;font-size:0.85rem;padding:12px 0;list-style:none;display:flex;align-items:center;gap:8px"><i class="fas fa-sliders-h"></i> Customize Visible Tools <i class="fas fa-chevron-down" style="font-size:0.7rem;margin-left:auto;opacity:0.5"></i></summary><div id="roleToolChecks" style="display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:0 0 16px">',$.forEach(function(o){var r=k?k.indexOf(o)>=0:y?(g[y]?.tabs||[]).indexOf(o)>=0:!0;a+='<label style="display:flex;align-items:center;gap:8px;font-size:0.82rem;color:var(--steel);cursor:pointer;padding:6px 10px;border-radius:3px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.06);transition:all 0.2s"><input type="checkbox" data-tab="'+o+'" '+(r?"checked":"")+' onchange="onRoleToolToggle()" style="accent-color:#00aaff;width:16px;height:16px;flex-shrink:0"> <span>'+(de[o]||o)+"</span></label>"}),a+=`</div></details><div style="display:flex;gap:10px;justify-content:flex-end"><button onclick="document.getElementById('roleModal').remove()" style="background:rgba(255,255,255,0.06);color:var(--steel);border:1px solid var(--border);border-radius:3px;padding:8px 20px;cursor:pointer">Cancel</button><button onclick="applyRole()" style="background:var(--accent);color:#fff;border:none;border-radius:3px;padding:8px 24px;cursor:pointer;font-weight:600">Apply Role</button></div></div>`,e.innerHTML=a,document.body.appendChild(e)}function ue(e){y=e,document.querySelectorAll(".role-card").forEach(function(c){c.style.borderColor="var(--border)",c.style.background=""});var a=document.querySelector('.role-card[data-role="'+e+'"]');a&&(a.style.borderColor="var(--accent)",a.style.background="rgba(0,170,255,0.08)");var o=g[e].tabs;document.querySelectorAll('#roleToolChecks input[type="checkbox"]').forEach(function(c){c.checked=o.indexOf(c.dataset.tab)>=0});var r=document.getElementById("roleTitle");r&&!r.value&&(r.value=g[e].label)}function fe(){k=[],document.querySelectorAll('#roleToolChecks input[type="checkbox"]').forEach(function(e){e.checked&&k.push(e.dataset.tab)})}function me(){var e=document.getElementById("roleTitle")?.value?.trim()||"";q=e,sessionStorage.setItem("s4_user_role",y),sessionStorage.setItem("s4_user_title",q);var a;k?(a=k,sessionStorage.setItem("s4_visible_tabs",JSON.stringify(k))):y&&g[y]?(a=g[y].tabs,sessionStorage.removeItem("s4_visible_tabs")):a=$,ee(a),te(),typeof reloadVaultForRole=="function"&&reloadVaultForRole(),document.getElementById("roleModal")?.remove(),s4Notify("Role Applied",(e||g[y]?.label||"Custom")+" — "+a.length+" tools active","success")}function ee(e){document.querySelectorAll(".ils-hub-tab").forEach(function(a){var o=a.getAttribute("onclick")||"",r=o.match(/switchHubTab\('([^']+)'/);if(r){var c=r[1];a.style.display=e.indexOf(c)>=0?"":"none"}}),document.querySelectorAll(".ils-tool-card[onclick]").forEach(function(a){var o=a.getAttribute("onclick")||"",r=o.match(/openILSTool\('([^']+)'/);r&&(a.style.display=e.indexOf(r[1])>=0?"":"none")})}function te(){var e=document.getElementById("roleBadge");if(!e){var a=document.querySelector(".ils-hub-tabs")?.previousElementSibling;if(!a)return;var o=a.querySelector("div:last-child");if(!o)return;e=document.createElement("span"),e.id="roleBadge",e.style.cssText="display:inline-flex;align-items:center;gap:6px;padding:5px 12px;border-radius:3px;font-size:0.75rem;font-weight:600;background:rgba(0,170,255,0.1);border:1px solid rgba(0,170,255,0.25);color:#00aaff;cursor:pointer;transition:all 0.2s;hover:background:rgba(0,170,255,0.2)",e.title="Click to change your role",e.onclick=K,o.appendChild(e)}var r=y?g[y]?.icon||"fa-user":"fa-user-cog",c=q||(y?g[y]?.label:"Set Role");e.innerHTML='<i class="fas '+r+'"></i> '+c+' <i class="fas fa-gear" style="font-size:0.6rem;opacity:0.6"></i>'}function X(){if(y){var e=k||(g[y]?g[y].tabs:$);ee(e),typeof reloadVaultForRole=="function"&&reloadVaultForRole()}te(),y||setTimeout(function(){var a=document.getElementById("platformWorkspace");a&&a.style.display==="block"&&sessionStorage.getItem("s4_onboard_done")&&K()},2500)}(function(){function e(t){return Math.round(t).toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",")}function a(){try{var t=function(M){var P=document.getElementById(M);return P&&parseFloat(P.value)||0},i=t("roiPrograms"),n=t("roiRecords"),l=t("roiFTEs"),s=t("roiRate"),u=t("roiAudit"),d=t("roiError"),p=t("roiIncidents"),b=t("roiLicense"),v=i*n,h=1+Math.sqrt(Math.max(0,v))/50,B=l*2080,S=B*s,x=S*.65*h,w=p*d*.9,O=u*.7*Math.max(1,i/5),D=v>0?x/12/v:0,L=x+w+O,I=L-b,C=b>0?I/b*100:0,T=L>0?Math.ceil(b/L*12):0,A=L*5-b*5,z=function(M,P,Y){var H=document.getElementById(M);H&&(H.textContent=P,Y&&(H.style.color=Y))};z("roiSavings","$"+e(I),I>0?"#00cc66":"#ff4444"),z("roiPercent",C.toFixed(0)+"%",C>0?"#00cc66":"#ff4444"),z("roiPayback",T+" mo",null),z("roi5Year","$"+e(A),A>0?"#00cc66":"#ff4444");var j=document.getElementById("roiOutput");j&&(j.innerHTML='<div style="background:var(--surface);border:1px solid var(--border);border-radius:3px;padding:20px;margin-top:12px"><div class="section-label"><i class="fas fa-chart-line"></i> ROI BREAKDOWN</div><div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;font-size:0.85rem;margin-bottom:16px"><div><span style="color:var(--steel)">Labor Automation (65%)</span><br><strong style="color:#00cc66">$'+e(x)+'</strong></div><div><span style="color:var(--steel)">Error Reduction (90%)</span><br><strong style="color:#00cc66">$'+e(w)+'</strong></div><div><span style="color:var(--steel)">Audit Cost Reduction (70%)</span><br><strong style="color:#00cc66">$'+e(O)+'</strong></div><div><span style="color:var(--steel)">S4 Ledger License</span><br><strong style="color:#ff6b6b">-$'+e(b)+'</strong></div></div><hr style="border-color:var(--border);margin:12px 0"><div style="display:flex;justify-content:space-between;align-items:center"><div><span style="color:var(--steel);font-size:0.82rem">Net Annual Savings</span><br><span style="font-size:1.5rem;font-weight:800;color:'+(I>0?"#00cc66":"#ff4444")+'">$'+e(I)+'</span></div><div><span style="color:var(--steel);font-size:0.82rem">Per-Record Savings</span><br><span style="font-size:1.1rem;font-weight:700;color:var(--accent)">$'+D.toFixed(2)+'/record</span></div><div><span style="color:var(--steel);font-size:0.82rem">Volume Multiplier</span><br><span style="font-size:1.1rem;font-weight:700;color:var(--accent)">'+h.toFixed(2)+"x</span></div></div></div>");try{typeof renderROICharts=="function"&&renderROICharts()}catch{}}catch{}}function o(){var t=["roiPrograms","roiRecords","roiFTEs","roiRate","roiAudit","roiError","roiIncidents","roiLicense"],i=0;return t.forEach(function(n){var l=document.getElementById(n);l&&(l.removeAttribute("oninput"),l.addEventListener("input",a),i++)}),i>0&&a(),i}function r(){var t={};try{var i=document.querySelectorAll('#ilsCoverage input[type="checkbox"], .ils-checklist input[type="checkbox"]'),n=0,l=i.length||1;i.forEach(function(d){d.checked&&n++}),t.ilsPct=Math.round(n/l*100)}catch{t.ilsPct=0}var s=["pctCMMC","pctNIST","pctDFARS","pctFAR","pctILS","pctDMSMSmgmt"];t.comp=s.map(function(d){var p=document.getElementById(d);return p&&parseInt(p.textContent)||0}),t.vault=typeof s4Vault<"u"?s4Vault.length:typeof getLocalRecords=="function"?getLocalRecords().length:0,t.actions=typeof s4ActionItems<"u"?s4ActionItems.length:0,t.actionsDone=0,typeof s4ActionItems<"u"&&s4ActionItems.forEach(function(d){d.status==="done"&&t.actionsDone++});var u=function(d){var p=document.getElementById(d);return p&&parseFloat(p.value)||0};return t.roiPrograms=u("roiPrograms"),t.roiRecords=u("roiRecords"),t.roiFTEs=u("roiFTEs"),t.roiRate=u("roiRate"),t.roiLicense=u("roiLicense"),t.roiAudit=u("roiAudit"),t.stats=typeof stats<"u"?stats:{anchored:0,slsFees:0},t.dmsmsItems=typeof dmsmsItems<"u"?dmsmsItems:[],t.riskItems=typeof riskItems<"u"?riskItems:[],t}var c={gapRadarChart:function(){var t=r(),i=Math.min(100,20+t.vault*3),n=Math.min(100,15+t.vault*4),l=Math.min(100,t.comp[0]||10),s=Math.min(100,10+(t.dmsmsItems.length||0)*8),u=Math.min(100,15+(t.riskItems.length||0)*5),d=Math.min(100,20+t.ilsPct*.6),p=[i,n,l,s,u,d].map(function(b){return Math.min(100,b+30+Math.random()*5|0)});return{type:"radar",data:{labels:["Tracking","Audit","Compliance","Obsolescence","Risk","Budget"],datasets:[{label:"Current (Manual)",data:[i,n,l,s,u,d],borderColor:"#ff6b6b",backgroundColor:"rgba(255,107,107,0.1)",pointBackgroundColor:"#ff6b6b"},{label:"With S4 Ledger",data:p,borderColor:"#00aaff",backgroundColor:"rgba(0,170,255,0.1)",pointBackgroundColor:"#00aaff"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#8ea4b8",font:{size:10}}}},scales:{r:{grid:{color:"rgba(255,255,255,0.06)"},angleLines:{color:"rgba(255,255,255,0.06)"},pointLabels:{color:"#8ea4b8",font:{size:9}},ticks:{display:!1}}}}}},gapBarChart:function(){var t=r(),i=Math.max(0,100-(20+t.vault*3)),n=Math.max(0,100-(15+t.vault*4)),l=Math.max(0,100-(t.comp[0]||10)),s=Math.max(0,100-(10+(t.dmsmsItems.length||0)*8)),u=Math.max(0,100-(15+(t.riskItems.length||0)*5)),d=Math.max(0,100-(20+t.ilsPct*.6));return{type:"bar",data:{labels:["Tracking","Audit","Compliance","Obsolescence","Risk","Budget"],datasets:[{label:"Gap %",data:[i,n,l,s,u,d],backgroundColor:["#ff6b6b","#fb923c","#c9a84c","#00aaff","#38bdf8","#06b6d4"],borderWidth:0,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},max:100},y:{ticks:{color:"#8ea4b8",font:{size:9}},grid:{display:!1}}}}}},dmsmsPieChart:function(){var t=r(),i=t.dmsmsItems,n=0,l=0,s=0,u=0,d=0;return i.length>0?i.forEach(function(p){var b=(p.status||"").toLowerCase();b.indexOf("obsolete")>=0?s++:b.indexOf("risk")>=0||b.indexOf("diminish")>=0?l++:b.indexOf("discontin")>=0?u++:b.indexOf("eol")>=0||b.indexOf("last")>=0?d++:n++}):(n=45,l=20,s=15,u=10,d=10),{type:"doughnut",data:{labels:["Active","At Risk","Obsolete","Discontinued","EOL Planned"],datasets:[{data:[n,l,s,u,d],backgroundColor:["#00aaff","#c9a84c","#ff6b6b","#00aaff","#6b7d93"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#8ea4b8",font:{size:9},padding:6}}}}}},readinessGauge:function(){var t=r(),i=Math.max(30,t.ilsPct),n=Math.min(100,i+15+(t.vault>5?10:0)),l=Math.min(100,i+(t.dmsmsItems.length>0?-5:8)),s=Math.min(100,i-12+t.vault*2),u=Math.min(100,i+20),d=Math.min(100,i+6+t.actionsDone*3),p=Math.min(100,i+12);return{type:"bar",data:{labels:["Personnel","Equipment","Supply","Training","Maintenance","C4ISR"],datasets:[{label:"Readiness %",data:[n,l,s,u,d,p],backgroundColor:"rgba(0,170,255,0.6)",borderColor:"#00aaff",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{ticks:{color:"#8ea4b8",font:{size:9}},grid:{display:!1}},y:{ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},beginAtZero:!0,max:100}}}}},complianceRadarChart:function(){var t=r(),i=t.comp[2]||30,n=Math.min(100,40+t.vault*4),l=t.comp[1]||25,s=t.comp[0]||20,u=Math.min(100,30+t.ilsPct*.5),d=Math.min(100,35+t.vault*3);return{type:"polarArea",data:{labels:["DFARS","ITAR","NIST 800-171","CMMC","ISO 27001","SOX"],datasets:[{data:[i,n,l,s,u,d],backgroundColor:["rgba(0,170,255,0.5)","rgba(201,168,76,0.5)","rgba(56,189,248,0.5)","rgba(255,107,107,0.5)","rgba(0,170,255,0.5)","rgba(6,182,212,0.5)"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#8ea4b8",font:{size:9},padding:6}}},scales:{r:{grid:{color:"rgba(255,255,255,0.06)"},ticks:{display:!1}}}}}},roiLineChart:function(){var t=r(),i=t.roiPrograms*t.roiRecords,n=1+Math.sqrt(Math.max(0,i))/50,l=t.roiFTEs*2080*t.roiRate,s=l*.65*n,u=t.roiAudit*.7*Math.max(1,t.roiPrograms/5),d=s+u,p=t.roiLicense||1,b=[],v=[],h=t.roiPrograms>0||t.roiFTEs>0||t.roiLicense>0;if(h)for(var B=0,S=1;S<=5;S++)for(var x=1;x<=4;x++){b.push("Y"+S+"-Q"+x);var w=(S-1)*4+x,O=.2+.65*(1-Math.exp(-.18*w)),D=d/4*O,L=p/4;B+=D-L;var I=p>0?B/p*100:0;v.push(Math.round(I))}if(!h||v.length===0||v.every(function(A){return A===0})){b=[],v=[];for(var C=1;C<=5;C++)for(var T=1;T<=4;T++){b.push("Y"+C+"-Q"+T);var w=(C-1)*4+T;v.push(Math.round(-15+3.5*w+.8*Math.pow(w,1.45)))}}return{type:"line",data:{labels:b,datasets:[{label:"Cumulative ROI %",data:v,borderColor:"#00cc66",backgroundColor:"rgba(0,204,102,0.1)",fill:!0,tension:.3,pointRadius:2,pointBackgroundColor:"#00cc66"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"5-Year Cumulative ROI",color:"#8ea4b8",font:{size:11}}},scales:{x:{ticks:{color:"#8ea4b8",font:{size:8},maxRotation:45},grid:{display:!1}},y:{ticks:{color:"#6b7d93",font:{size:9},callback:function(A){return A+"%"}},grid:{color:"rgba(255,255,255,0.04)"},beginAtZero:!0}}}}},riskHeatChart:function(){var t=r(),i=[];if(t.riskItems.length>0)t.riskItems.forEach(function(u){i.push({x:u.likelihood||Math.ceil(Math.random()*9),y:u.impact||Math.ceil(Math.random()*9)})});else for(var n=Math.max(3,Math.min(12,3+t.vault+t.actions)),l=0;l<n;l++)i.push({x:1+Math.floor(Math.random()*9),y:1+Math.floor(Math.random()*9)});var s=i.map(function(u){var d=u.x*u.y;return d>=50?"rgba(255,70,70,0.8)":d>=25?"rgba(255,165,0,0.7)":d>=10?"rgba(201,168,76,0.6)":"rgba(0,170,255,0.5)"});return{type:"scatter",data:{datasets:[{label:"Risk Items",data:i,backgroundColor:s,borderColor:s,pointRadius:7}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:i.length+" Risk Items Mapped",color:"#8ea4b8",font:{size:11}}},scales:{x:{title:{display:!0,text:"Likelihood →",color:"#8ea4b8",font:{size:9}},ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},min:0,max:10},y:{title:{display:!0,text:"Impact →",color:"#8ea4b8",font:{size:9}},ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},min:0,max:10}}}}},lifecyclePieChart:function(){var t=r(),i=Math.min(30,(t.dmsmsItems.length||0)*5),n=Math.min(15,t.ilsPct*.15);return{type:"line",data:{labels:["Intro","Growth","Maturity","Sustain","Phase Out","Disposal"],datasets:[{label:"Availability %",data:[95-i*.1,92-i*.2+n,88-i*.4+n,75-i*.6+n*2,50-i*.3+n,20+n*.5].map(function(l){return Math.round(Math.max(5,Math.min(100,l)))}),borderColor:"#00aaff",backgroundColor:"rgba(0,170,255,0.1)",fill:!0,tension:.3},{label:"Cost Index",data:[30,25+i*.3,35+i*.5,55+i*.8-n,70+i-n*2,90+i*.5-n].map(function(l){return Math.round(Math.max(5,Math.min(100,l)))}),borderColor:"#ff6b6b",backgroundColor:"rgba(255,107,107,0.05)",fill:!0,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#8ea4b8",font:{size:10}}}},scales:{x:{ticks:{color:"#8ea4b8",font:{size:9}},grid:{display:!1}},y:{ticks:{color:"#6b7d93",font:{size:9}},grid:{color:"rgba(255,255,255,0.04)"},beginAtZero:!0}}}}}};window._bpRenderInPanel=f;function f(t){if(!(typeof Chart>"u")){if(typeof injectChartContainers=="function")try{injectChartContainers()}catch{}var i=t.querySelectorAll("canvas");i.length!==0&&i.forEach(function(n){if(!n.getAttribute("data-bp-rendered")){var l=c[n.id];if(l)try{var s=Chart.getChart(n);s&&s.destroy(),!n.style.height&&!n.getAttribute("height")&&(n.style.height="220px"),n.style.width="100%",n.style.display="block";var u=n.closest(".chart-container");u&&(u.style.display="block",u.style.visibility="visible"),new Chart(n,l()),n.setAttribute("data-bp-rendered","1"),n.setAttribute("data-bp-ts",Date.now())}catch{}}})}}function m(){if(o()===0&&(setTimeout(o,2e3),setTimeout(o,5e3)),window.calcROI=a,typeof window.openILSTool=="function"){var t=window.openILSTool;window.openILSTool=function(n){t(n),setTimeout(function(){var l=document.getElementById(n);l&&f(l)},300),setTimeout(function(){var l=document.getElementById(n);l&&f(l)},800),setTimeout(function(){var l=document.getElementById(n);l&&f(l)},2e3)}}if(typeof window.switchHubTab=="function"){var i=window.switchHubTab;window.switchHubTab=function(n,l){i(n,l),setTimeout(function(){var s=document.getElementById(n);s&&f(s)},400)}}document.querySelectorAll(".ils-hub-panel").forEach(function(n){var l=new MutationObserver(function(s){s.forEach(function(u){u.target.classList&&u.target.classList.contains("active")&&setTimeout(function(){f(u.target)},400)})});l.observe(n,{attributes:!0,attributeFilter:["class","style"]})}),setTimeout(function(){document.querySelectorAll(".ils-hub-panel.active").forEach(function(n){f(n)})},2e3),setTimeout(function(){if(typeof loadPerformanceMetrics=="function")try{loadPerformanceMetrics()}catch{}},1500),setTimeout(o,3e3),typeof X=="function"&&X()}window._s4RefreshCharts=function(){document.querySelectorAll("canvas[data-bp-rendered]").forEach(function(i){i.removeAttribute("data-bp-rendered")});var t=document.querySelector(".ils-hub-panel.active");t&&f(t)},document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m()})();window.applyRole=me;window.onRoleToolToggle=fe;window.selectRolePreset=ue;
